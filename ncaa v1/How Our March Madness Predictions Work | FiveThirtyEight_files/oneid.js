!function(){var n;window.oid=OneID.get(DisneyOneID.config),n=new Event("oneidInit"),window.oid.init().then(function(){document.dispatchEvent(n)}).catch(function(){console.log("There was an error connecting to One ID.")})}();is.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};e.exports&&(e.exports=t),"function"===typeof window.define&&window.define([],(function(){return t})),t.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var n,r,o,i,s,a=this._tables[0][4],c=this._tables[1],u=e.length,l=1;if(4!==u&&6!==u&&8!==u)throw new t.exception.invalid("invalid aes key size");for(this._key=[i=e.slice(0),s=[]],n=u;n<4*u+28;n++)o=i[n-1],(n%u===0||8===u&&n%u===4)&&(o=a[o>>>24]<<24^a[o>>16&255]<<16^a[o>>8&255]<<8^a[255&o],n%u===0&&(o=o<<8^o>>>24^l<<24,l=l<<1^283*(l>>7))),i[n]=i[n-u]^o;for(r=0;n;r++,n--)o=i[3&r?n:n-4],s[r]=n<=4||r<4?o:c[0][a[o>>>24]]^c[1][a[o>>16&255]]^c[2][a[o>>8&255]]^c[3][a[255&o]]},t.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e,t,n,r,o,i,s,a,c=this._tables[0],u=this._tables[1],l=c[4],d=u[4],f=[],p=[];for(e=0;e<256;e++)p[(f[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=r||1,n=p[n]||1)for(i=(i=n^n<<1^n<<2^n<<3^n<<4)>>8^255&i^99,l[t]=i,d[i]=t,a=16843009*f[o=f[r=f[t]]]^65537*o^257*r^16843008*t,s=257*f[i]^16843008*i,e=0;e<4;e++)c[e][t]=s=s<<24^s>>>8,u[e][i]=a=a<<24^a>>>8;for(e=0;e<5;e++)c[e]=c[e].slice(0),u[e]=u[e].slice(0)},_crypt:function(e,n){if(4!==e.length)throw new t.exception.invalid("invalid aes block size");var r,o,i,s,a=this._key[n],c=e[0]^a[0],u=e[n?3:1]^a[1],l=e[2]^a[2],d=e[n?1:3]^a[3],f=a.length/4-2,p=4,h=[0,0,0,0],g=this._tables[n],E=g[0],m=g[1],_=g[2],y=g[3],I=g[4];for(s=0;s<f;s++)r=E[c>>>24]^m[u>>16&255]^_[l>>8&255]^y[255&d]^a[p],o=E[u>>>24]^m[l>>16&255]^_[d>>8&255]^y[255&c]^a[p+1],i=E[l>>>24]^m[d>>16&255]^_[c>>8&255]^y[255&u]^a[p+2],d=E[d>>>24]^m[c>>16&255]^_[u>>8&255]^y[255&l]^a[p+3],p+=4,c=r,u=o,l=i;for(s=0;s<4;s++)h[n?3&-s:s]=I[c>>>24]<<24^I[u>>16&255]<<16^I[l>>8&255]<<8^I[255&d]^a[p++],r=c,c=u,u=l,l=d,d=r;return h}},t.bitArray={bitSlice:function(e,n,r){return e=t.bitArray._shiftRight(e.slice(n/32),32-(31&n)).slice(1),void 0===r?e:t.bitArray.clamp(e,r-n)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,n){if(0===e.length||0===n.length)return e.concat(n);var r=e[e.length-1],o=t.bitArray.getPartial(r);return 32===o?e.concat(n):t.bitArray._shiftRight(n,o,0|r,e.slice(0,e.length-1))},bitLength:function(e){var n,r=e.length;return 0===r?0:(n=e[r-1],32*(r-1)+t.bitArray.getPartial(n))},clamp:function(e,n){if(32*e.length<n)return e;var r=(e=e.slice(0,Math.ceil(n/32))).length;return n&=31,r>0&&n&&(e[r-1]=t.bitArray.partial(n,e[r-1]&2147483648>>n-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,n){if(t.bitArray.bitLength(e)!==t.bitArray.bitLength(n))return!1;var r,o=0;for(r=0;r<e.length;r++)o|=e[r]^n[r];return 0===o},_shiftRight:function(e,n,r,o){var i,s,a;for(void 0===o&&(o=[]);n>=32;n-=32)o.push(r),r=0;if(0===n)return o.concat(e);for(i=0;i<e.length;i++)o.push(r|e[i]>>>n),r=e[i]<<32-n;return s=e.length?e[e.length-1]:0,a=t.bitArray.getPartial(s),o.push(t.bitArray.partial(n+a&31,n+a>32?r:o.pop(),1)),o},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},t.codec.utf8String={fromBits:function(e){var n,r,o="",i=t.bitArray.bitLength(e);for(n=0;n<i/8;n++)0===(3&n)&&(r=e[n/4]),o+=String.fromCharCode(r>>>24),r<<=8;return decodeURIComponent(escape(o))},toBits:function(e){e=unescape(encodeURIComponent(e));var n,r=[],o=0;for(n=0;n<e.length;n++)o=o<<8|e.charCodeAt(n),3===(3&n)&&(r.push(o),o=0);return 3&n&&r.push(t.bitArray.partial(8*(3&n),o)),r}},t.codec.hex={fromBits:function(e){var n,r="";for(n=0;n<e.length;n++)r+=(0xf00000000000+(0|e[n])).toString(16).substr(4);return r.substr(0,t.bitArray.bitLength(e)/4)},toBits:function(e){var n,r,o=[];for(r=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",n=0;n<e.length;n+=8)o.push(0^parseInt(e.substr(n,8),16));return t.bitArray.clamp(o,4*r)}},t.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,n,r){var o,i="",s=0,a=t.codec.base64._chars,c=0,u=t.bitArray.bitLength(e);for(r&&(a=a.substr(0,62)+"-_"),o=0;6*i.length<u;)i+=a.charAt((c^e[o]>>>s)>>>26),s<6?(c=e[o]<<6-s,s+=26,o++):(c<<=6,s-=6);for(;3&i.length&&!n;)i+="=";return i},toBits:function(e,n){e=e.replace(/\s|=/g,"");var r,o,i=[],s=0,a=t.codec.base64._chars,c=0;for(n&&(a=a.substr(0,62)+"-_"),r=0;r<e.length;r++){if((o=a.indexOf(e.charAt(r)))<0)throw new t.exception.invalid("this isn't base64!");s>26?(s-=26,i.push(c^o>>>s),c=o<<32-s):c^=o<<32-(s+=6)}return 56&s&&i.push(t.bitArray.partial(56&s,c,1)),i}},t.codec.base64url={fromBits:function(e){return t.codec.base64.fromBits(e,1,1)},toBits:function(e){return t.codec.base64.toBits(e,1)}},t.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},t.hash.sha256.hash=function(e){return(new t.hash.sha256).update(e).finalize()},t.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"===typeof e&&(e=t.codec.utf8String.toBits(e));var n,r=this._buffer=t.bitArray.concat(this._buffer,e),o=this._length,i=this._length=o+t.bitArray.bitLength(e);for(n=512+o&-512;n<=i;n+=512)this._block(r.splice(0,16));return this},finalize:function(){var e,n=this._buffer,r=this._h;for(e=(n=t.bitArray.concat(n,[t.bitArray.partial(1,1)])).length+2;15&e;e++)n.push(0);for(n.push(Math.floor(this._length/4294967296)),n.push(0|this._length);n.length;)this._block(n.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function(){var e,t=0,n=2;function r(e){return 4294967296*(e-Math.floor(e))|0}e:for(;t<64;n++){for(e=2;e*e<=n;e++)if(n%e===0)continue e;t<8&&(this._init[t]=r(Math.pow(n,.5))),this._key[t]=r(Math.pow(n,1/3)),t++}},_block:function(e){var t,n,r,o,i=e.slice(0),s=this._h,a=this._key,c=s[0],u=s[1],l=s[2],d=s[3],f=s[4],p=s[5],h=s[6],g=s[7];for(t=0;t<64;t++)t<16?n=i[t]:(r=i[t+1&15],o=i[t+14&15],n=i[15&t]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+i[15&t]+i[t+9&15]|0),n=n+g+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(h^f&(p^h))+a[t],g=h,h=p,p=f,f=d+n|0,d=l,l=u,c=n+((u=c)&l^d&(u^l))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;s[0]=s[0]+c|0,s[1]=s[1]+u|0,s[2]=s[2]+l|0,s[3]=s[3]+d|0,s[4]=s[4]+f|0,s[5]=s[5]+p|0,s[6]=s[6]+h|0,s[7]=s[7]+g|0}},t.mode.ccm={name:"ccm",encrypt:function(e,n,r,o,i){var s,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(r)/8,d=u.bitLength(c)/8;if(i=i||64,o=o||[],l<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&d>>>8*s;s++);return s<15-l&&(s=15-l),r=u.clamp(r,8*(15-s)),a=t.mode.ccm._computeTag(e,n,r,o,i,s),c=t.mode.ccm._ctrMode(e,c,r,a,i,s),u.concat(c.data,c.tag)},decrypt:function(e,n,r,o,i){i=i||64,o=o||[];var s,a,c=t.bitArray,u=c.bitLength(r)/8,l=c.bitLength(n),d=c.clamp(n,l-i),f=c.bitSlice(n,l-i);if(l=(l-i)/8,u<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&l>>>8*s;s++);if(s<15-u&&(s=15-u),r=c.clamp(r,8*(15-s)),d=t.mode.ccm._ctrMode(e,d,r,f,i,s),a=t.mode.ccm._computeTag(e,d.data,r,o,i,s),!c.equal(d.tag,a))throw new t.exception.corrupt("ccm: tag doesn't match");return d.data},_computeTag:function(e,n,r,o,i,s){var a,c,u,l=[],d=t.bitArray,f=d._xor4;if((i/=8)%2||i<4||i>16)throw new t.exception.invalid("ccm: invalid tag length");if(o.length>4294967295||n.length>4294967295)throw new t.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[d.partial(8,(o.length?64:0)|i-2<<2|s-1)],(a=d.concat(a,r))[3]|=d.bitLength(n)/8,a=e.encrypt(a),o.length)for((c=d.bitLength(o)/8)<=65279?l=[d.partial(16,c)]:c<=4294967295&&(l=d.concat([d.partial(16,65534)],[c])),l=d.concat(l,o),u=0;u<l.length;u+=4)a=e.encrypt(f(a,l.slice(u,u+4).concat([0,0,0])));for(u=0;u<n.length;u+=4)a=e.encrypt(f(a,n.slice(u,u+4).concat([0,0,0])));return d.clamp(a,8*i)},_ctrMode:function(e,n,r,o,i,s){var a,c,u,l=t.bitArray,d=l._xor4,f=n.length,p=l.bitLength(n);if(u=l.concat([l.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),o=l.bitSlice(d(o,e.encrypt(u)),0,i),!f)return{tag:o,data:[]};for(c=0;c<f;c+=4)u[3]++,a=e.encrypt(u),n[c]^=a[0],n[c+1]^=a[1],n[c+2]^=a[2],n[c+3]^=a[3];return{tag:o,data:l.clamp(n,p)}}},t.mode.ocb2={name:"ocb2",encrypt:function(e,n,r,o,i,s){if(128!==t.bitArray.bitLength(r))throw new t.exception.invalid("ocb iv must be 128 bits");var a,c,u,l,d=t.mode.ocb2._times2,f=t.bitArray,p=f._xor4,h=[0,0,0,0],g=d(e.encrypt(r)),E=[];for(o=o||[],i=i||64,a=0;a+4<n.length;a+=4)h=p(h,c=n.slice(a,a+4)),E=E.concat(p(g,e.encrypt(p(g,c)))),g=d(g);return c=n.slice(a),u=f.bitLength(c),l=e.encrypt(p(g,[0,0,0,u])),c=f.clamp(p(c.concat([0,0,0]),l),u),h=p(h,p(c.concat([0,0,0]),l)),h=e.encrypt(p(h,p(g,d(g)))),o.length&&(h=p(h,s?o:t.mode.ocb2.pmac(e,o))),E.concat(f.concat(c,f.clamp(h,i)))},decrypt:function(e,n,r,o,i,s){if(128!==t.bitArray.bitLength(r))throw new t.exception.invalid("ocb iv must be 128 bits");i=i||64;var a,c,u,l,d=t.mode.ocb2._times2,f=t.bitArray,p=f._xor4,h=[0,0,0,0],g=d(e.encrypt(r)),E=t.bitArray.bitLength(n)-i,m=[];for(o=o||[],a=0;a+4<E/32;a+=4)c=p(g,e.decrypt(p(g,n.slice(a,a+4)))),h=p(h,c),m=m.concat(c),g=d(g);if(u=E-32*a,l=e.encrypt(p(g,[0,0,0,u])),c=p(l,f.clamp(n.slice(a),u).concat([0,0,0])),h=p(h,c),h=e.encrypt(p(h,p(g,d(g)))),o.length&&(h=p(h,s?o:t.mode.ocb2.pmac(e,o))),!f.equal(f.clamp(h,i),f.bitSlice(n,E)))throw new t.exception.corrupt("ocb: tag doesn't match");return m.concat(f.clamp(c,u))},pmac:function(e,n){var r,o,i=t.mode.ocb2._times2,s=t.bitArray,a=s._xor4,c=[0,0,0,0],u=e.encrypt([0,0,0,0]);for(u=a(u,i(i(u))),r=0;r+4<n.length;r+=4)u=i(u),c=a(c,e.encrypt(a(u,n.slice(r,r+4))));return o=n.slice(r),s.bitLength(o)<128&&(u=a(u,i(u)),o=s.concat(o,[-2147483648,0,0,0])),c=a(c,o),e.encrypt(a(i(a(u,i(u))),c))},_times2:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},t.mode.gcm={name:"gcm",encrypt:function(e,n,r,o,i){var s,a=n.slice(0),c=t.bitArray;return i=i||128,o=o||[],s=t.mode.gcm._ctrMode(!0,e,a,o,r,i),c.concat(s.data,s.tag)},decrypt:function(e,n,r,o,i){var s,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(c);if(o=o||[],(i=i||128)<=l?(a=u.bitSlice(c,l-i),c=u.bitSlice(c,0,l-i)):(a=c,c=[]),s=t.mode.gcm._ctrMode(!1,e,c,o,r,i),!u.equal(s.tag,a))throw new t.exception.corrupt("gcm: tag doesn't match");return s.data},_galoisMultiply:function(e,n){var r,o,i,s,a,c=t.bitArray._xor4;for(i=[0,0,0,0],s=n.slice(0),r=0;r<128;r++){for(0!==(e[Math.floor(r/32)]&1<<31-r%32)&&(i=c(i,s)),a=0!==(1&s[3]),o=3;o>0;o--)s[o]=s[o]>>>1|(1&s[o-1])<<31;s[0]=s[0]>>>1,a&&(s[0]=s[0]^225<<24)}return i},_ghash:function(e,n,r){var o,i,s=r.length;for(o=n.slice(0),i=0;i<s;i+=4)o[0]^=4294967295&r[i],o[1]^=4294967295&r[i+1],o[2]^=4294967295&r[i+2],o[3]^=4294967295&r[i+3],o=t.mode.gcm._galoisMultiply(o,e);return o},_ctrMode:function(e,n,r,o,i,s){var a,c,u,l,d,f,p,h,g,E,m,_,y=t.bitArray;for(g=r.length,E=y.bitLength(r),m=y.bitLength(o),_=y.bitLength(i),a=n.encrypt([0,0,0,0]),96===_?(c=i.slice(0),c=y.concat(c,[1])):(c=t.mode.gcm._ghash(a,[0,0,0,0],i),c=t.mode.gcm._ghash(a,c,[0,0,Math.floor(_/4294967296),4294967295&_])),u=t.mode.gcm._ghash(a,[0,0,0,0],o),f=c.slice(0),p=u.slice(0),e||(p=t.mode.gcm._ghash(a,u,r)),d=0;d<g;d+=4)f[3]++,l=n.encrypt(f),r[d]^=l[0],r[d+1]^=l[1],r[d+2]^=l[2],r[d+3]^=l[3];return r=y.clamp(r,E),e&&(p=t.mode.gcm._ghash(a,u,r)),h=[Math.floor(m/4294967296),4294967295&m,Math.floor(E/4294967296),4294967295&E],p=t.mode.gcm._ghash(a,p,h),l=n.encrypt(c),p[0]^=l[0],p[1]^=l[1],p[2]^=l[2],p[3]^=l[3],{tag:y.bitSlice(p,0,s),data:r}}},t.misc.hmac=function(e,n){this._hash=n=n||t.hash.sha256;var r,o=[[],[]],i=n.prototype.blockSize/32;for(this._baseHash=[new n,new n],e.length>i&&(e=n.hash(e)),r=0;r<i;r++)o[0][r]=909522486^e[r],o[1][r]=1549556828^e[r];this._baseHash[0].update(o[0]),this._baseHash[1].update(o[1]),this._resultHash=new n(this._baseHash[0])},t.misc.hmac.prototype.encrypt=t.misc.hmac.prototype.mac=function(e){if(this._updated)throw new t.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},t.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},t.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},t.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(e).finalize();return this.reset(),t},t.misc.pbkdf2=function(e,n,r,o,i){if(r=r||1e3,o<0||r<0)throw t.exception.invalid("invalid params to pbkdf2");"string"===typeof e&&(e=t.codec.utf8String.toBits(e)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n));var s,a,c,u,l,d=new(i=i||t.misc.hmac)(e),f=[],p=t.bitArray;for(l=1;32*f.length<(o||1);l++){for(s=a=d.encrypt(p.concat(n,[l])),c=1;c<r;c++)for(a=d.encrypt(a),u=0;u<a.length;u++)s[u]^=a[u];f=f.concat(s)}return o&&(f=p.clamp(f,o)),f},t.prng=function(e){this._pools=[new t.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},t.prng.prototype={randomWords:function(e,n){var r,o,i=[],s=this.isReady(n);if(s===this._NOT_READY)throw new t.exception.notReady("generator isn't seeded");for(s&this._REQUIRES_RESEED&&this._reseedFromPools(!(s&this._READY)),r=0;r<e;r+=4)(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),o=this._gen4words(),i.push(o[0],o[1],o[2],o[3]);return this._gate(),i.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=e},addEntropy:function(e,n,r){r=r||"user";var o,i,s,a,c=(new Date).valueOf(),u=this._robins[r],l=this.isReady(),d=0;switch(void 0===(o=this._collectorIds[r])&&(o=this._collectorIds[r]=this._collectorIdNext++),void 0===u&&(u=this._robins[r]=0),this._robins[r]=(this._robins[r]+1)%this._pools.length,typeof e){case"number":void 0===n&&(n=1),this._pools[u].update([o,this._eventId++,1,n,c,1,0|e]);break;case"object":if("[object Uint32Array]"===(a=Object.prototype.toString.call(e))){for(s=[],i=0;i<e.length;i++)s.push(e[i]);e=s}else for("[object Array]"!==a&&(d=1),i=0;i<e.length&&!d;i++)"number"!==typeof e[i]&&(d=1);if(!d){if(void 0===n)for(n=0,i=0;i<e.length;i++)for(s=e[i];s>0;)n++,s>>>=1;this._pools[u].update([o,this._eventId++,2,n,c,e.length].concat(e))}break;case"string":void 0===n&&(n=e.length),this._pools[u].update([o,this._eventId++,3,n,c,e.length]),this._pools[u].update(e);break;default:d=1}if(d)throw new t.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[u]+=n,this._poolStrength+=n,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[void 0!==e?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e||this._defaultParanoia];return this._strength>=t||this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new t.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,r,o=this._callbacks[e],i=[];for(r in o)o.hasOwnProperty(r)&&o[r]===t&&i.push(r);for(n=0;n<i.length;n++)delete o[r=i[n]]},_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function(){for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new t.cipher.aes(this._key)},_reseed:function(e){this._key=t.hash.sha256.hash(this._key.concat(e)),this._cipher=new t.cipher.aes(this._key);for(var n=0;n<4&&(this._counter[n]=this._counter[n]+1|0,!this._counter[n]);n++);},_reseedFromPools:function(e){var n,r=[],o=0;for(this._nextReseed=r[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,n=0;n<16;n++)r.push(4294967296*Math.random()|0);for(n=0;n<this._pools.length&&(r=r.concat(this._pools[n].finalize()),o+=this._poolEntropy[n],this._poolEntropy[n]=0,e||!(this._reseedCount&1<<n));n++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new t.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=o,o>this._strength&&(this._strength=o),this._reseedCount++,this._reseed(r)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var n,r;try{n=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch(e){n=0,r=0}0!=n&&0!=r&&t.random.addEntropy([n,r],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(e){var n=e.touches[0]||e.changedTouches[0],r=n.pageX||n.clientX,o=n.pageY||n.clientY;t.random.addEntropy([r,o],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?t.random.addEntropy(window.performance.now(),e,"loadtime"):t.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var n=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var r=window.orientation;"number"===typeof r&&t.random.addEntropy(r,1,"accelerometer")}n&&t.random.addEntropy(n,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,n){var r,o=t.random._callbacks[e],i=[];for(r in o)o.hasOwnProperty(r)&&i.push(o[r]);for(r=0;r<i.length;r++)i[r](n)}},t.random=new t.prng(6),function(){try{var n,r,o;if(e.exports&&(r=null)&&r.randomBytes)n=r.randomBytes(128),n=new Uint32Array(new Uint8Array(n).buffer),t.random.addEntropy(n,1024,"crypto.randomBytes");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){if(o=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(o);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(o)}t.random.addEntropy(o,1024,"crypto.getRandomValues")}}catch(e){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}}(),t.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(e,n,r,o){r=r||{},o=o||{};var i,s,a,c=t.json,u=c._add({iv:t.random.randomWords(4,0)},c.defaults);if(c._add(u,r),a=u.adata,"string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json encrypt: invalid parameters");return"string"===typeof e?(e=(i=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=i.salt):t.ecc&&e instanceof t.ecc.elGamal.publicKey&&(i=e.kem(),u.kemtag=i.tag,e=i.key.slice(0,u.ks/32)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n)),"string"===typeof a&&(u.adata=a=t.codec.utf8String.toBits(a)),s=new t.cipher[u.cipher](e),c._add(o,u),o.key=e,u.ct=t.mode[u.mode].encrypt(s,n,u.iv,a,u.ts),u},encrypt:function(e,n,r,o){if(e&&n){var i=t.json,s=i._encrypt.apply(i,arguments);return i.encode(s)}},_decrypt:function(e,n,r,o){r=r||{},o=o||{};var i,s,a,c=t.json,u=c._add(c._add(c._add({},c.defaults),n),r,!0),l=u.adata;if("string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||!u.iv||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json decrypt: invalid parameters");return"string"===typeof e?(e=(s=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=s.salt):t.ecc&&e instanceof t.ecc.elGamal.secretKey&&(e=e.unkem(t.codec.base64.toBits(u.kemtag)).slice(0,u.ks/32)),"string"===typeof l&&(l=t.codec.utf8String.toBits(l)),a=new t.cipher[u.cipher](e),i=t.mode[u.mode].decrypt(a,u.ct,u.iv,l,u.ts),c._add(o,u),o.key=e,1===r.raw?i:t.codec.utf8String.fromBits(i)},decrypt:function(e,n,r,o){if(e&&n){var i=t.json;return i._decrypt(e,i.decode(n),r,o)}},encode:function(e){var n,r="{",o="";for(n in e)if(e.hasOwnProperty(n)){if(!n.match(/^[a-z0-9]+$/i))throw new t.exception.invalid("json encode: invalid property name");switch(r+=o+'"'+n+'":',o=",",typeof e[n]){case"number":case"boolean":r+=e[n];break;case"string":r+='"'+escape(e[n])+'"';break;case"object":r+='"'+t.codec.base64.fromBits(e[n],0)+'"';break;default:throw new t.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){if(!(e=e.replace(/\s/g,"")).match(/^\{.*\}$/))throw new t.exception.invalid("json decode: this isn't json!");var n,r,o=e.replace(/^\{|\}$/g,"").split(/,/),i={};for(n=0;n<o.length;n++){if(!(r=o[n].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new t.exception.invalid("json decode: this isn't json!");r[3]?i[r[2]]=parseInt(r[3],10):r[4]?i[r[2]]=r[2].match(/^(ct|adata|salt|iv)$/)?t.codec.base64.toBits(r[4]):unescape(r[4]):r[5]&&(i[r[2]]="true"===r[5])}return i},_add:function(e,n,r){if(void 0===e&&(e={}),void 0===n)return e;var o;for(o in n)if(n.hasOwnProperty(o)){if(r&&void 0!==e[o]&&e[o]!==n[o])throw new t.exception.invalid("required parameter overridden");e[o]=n[o]}return e},_subtract:function(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},_filter:function(e,t){var n,r={};for(n=0;n<t.length;n++)void 0!==e[t[n]]&&(r[t[n]]=e[t[n]]);return r}},t.encrypt=t.json.encrypt,t.decrypt=t.json.decrypt,t.misc._pbkdf2Cache={},t.misc.cachedPbkdf2=function(e,n){var r,o,i,s,a=t.misc._pbkdf2Cache;return s=(n=n||{}).iter||1e3,(r=(o=a[e]=a[e]||{})[s]=o[s]||{firstSalt:n.salt&&n.salt.length?n.salt.slice(0):t.random.randomWords(2,0)})[i=void 0===n.salt?r.firstSalt:n.salt]=r[i]||t.misc.pbkdf2(e,i,n.iter),{key:r[i].slice(0),salt:i.slice(0)}}},698:(e,t,n)=>{"use strict";n.d(t,{tV:()=>_,h$:()=>y,uP:()=>I,d9:()=>d,kn:()=>E,_A:()=>l,U2:()=>f,hK:()=>c,KT:()=>g,kH:()=>w,qb:()=>u,Cd:()=>R,m8:()=>T,t8:()=>m,Vj:()=>p});var r=n(742);function o(){}function i(){}function s(e,t){let n;t=t||1/0;let r=e.length,o=null,i=[],s=0;for(;s<r;s++){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=o-55296<<10|n-56320|65536,o=null}else o&&((t-=3)>-1&&i.push(239,191,189),o=null);if(n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function a(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function c(e){if("string"===typeof e)return e.replace(/_/g,"-").toLowerCase()}function u(e){return e instanceof Date&&!isNaN(e.getTime())}function l(e){return null===e||"object"!==typeof e?e:(Object.keys(e).forEach((t=>{null!==e[t]&&"object"===typeof e[t]&&(e[t]=l(e[t]))})),Object.isFrozen(e)?e:Object.freeze(e))}function d(e){let t;if(null===e||"object"!==typeof e)return e;if("[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());try{t=new e.constructor}catch(e){return}return Object.keys(e).forEach((n=>{t[n]=d(e[n])})),t}function f(e,t){return t.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:void 0),e)}function p(){return`${h()}${h()}-${h()}-${h("4")}-${h((Math.floor(10*Math.random())%4+8).toString(16))}-${h()}${h()}${h()}`}function h(e){let t=Math.floor(65535*Math.random()).toString(16);for(let e=4-t.length;e>0;e--)t=`0${t}`;return e=(""+e).substring(0,4),!isNaN(parseInt(e,16))&&e.length?e+t.substr(e.length):t}function g(e=""){const t=e.match(/[^.]+(?:\.com?(?:\.[a-z]{2})?|(?:\.[a-z]+))?$/i);if(t&&t.length)return t[0].replace(/:[0-9]+$/,"")}function E(e=""){if("string"!==typeof e)return 0;let t=-1;const n=function(){const e=new Array(256);for(let t=0;t<e.length;t++){let n=t;for(let e=0;e<8;e++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n>>>0}return e}();for(let r=0;r<e.length;r++)t=t>>>8^n[255&(t^e.charCodeAt(r))];return(-1^t)>>>0}function m(e,t,n){let r,o;for("string"===typeof t&&(t=t.split(".")),r=0,o=t.length-1;r<o;r++)"undefined"!==typeof e[t[r]]&&null!==e[t[r]]||(e[t[r]]={}),e=e[t[r]];return e[t[o]]=n,e}function _(e){const t=r.b$(e);return new i("utf-8").decode(t)}function y(e){const t=new o("utf-8").encode(e);return r.JQ(t)}function I(e){if(null!==e&&"object"===typeof e&&0!==Object.keys(e).length)return btoa(JSON.stringify(e))}function w(e){return("string"===typeof e||e instanceof String)&&/^([a-zA-Z\d]|-|_)+$/.test(e)}function R(e,t){return e.length<=t?e:"..."+e.substring(e.length-t)}function T(e){return e.reduce(((e,[t,n])=>(e[t]=n,e)),{})}o.prototype.encode=function(e){return"undefined"===typeof Uint8Array?s(e):new Uint8Array(s(e))},i.prototype.decode=function(e){return function(e,t,n){let r="",o="";n=Math.min(e.length,n||1/0);for(let i=t=t||0;i<n;i++)e[i]<=127?(r+=a(o)+String.fromCharCode(e[i]),o=""):o+="%"+e[i].toString(16);return r+a(o)}(e,0,e.length)}},742:(e,t)=>{"use strict";t.b$=function(e){var t,n,i=c(e),s=i[0],a=i[1],u=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,d=a>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.JQ=function(e){for(var t,r=e.length,o=r%3,i=[],s=16383,a=0,c=r-o;a<c;a+=s)i.push(u(e,a,a+s>c?c:a+s));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=i.length;s<a;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,r){for(var o,i,s=[],a=t;a<r;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},961:(e,t,n)=>{var r,o=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var i={compressToBase64:function(e){if(null==e)return"";var n=i._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:i._decompress(e.length,32,(function(n){return o(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":i._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),r=0,o=t.length;r<o;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return i.decompress(t);for(var n=new Array(t.length/2),r=0,o=n.length;r<o;r++)n[r]=256*t[2*r]+t[2*r+1];var s=[];return n.forEach((function(t){s.push(e(t))})),i.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),i._decompress(e.length,32,(function(t){return o(n,e.charAt(t))})))},compress:function(t){return i._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,o,i,s={},a={},c="",u="",l="",d=2,f=3,p=2,h=[],g=0,E=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=f++,a[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(s,u))l=u;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,E==t-1?(E=0,h.push(n(g)),g=0):E++;for(o=l.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[l]}else for(o=s[l],r=0;r<p;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1;0==--d&&(d=Math.pow(2,p),p++),s[u]=f++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,E==t-1?(E=0,h.push(n(g)),g=0):E++;for(o=l.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o=0;for(o=l.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[l]}else for(o=s[l],r=0;r<p;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(o=2,r=0;r<p;r++)g=g<<1|1&o,E==t-1?(E=0,h.push(n(g)),g=0):E++,o>>=1;for(;;){if(g<<=1,E==t-1){h.push(n(g));break}E++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var o,i,s,a,c,u,l,d=[],f=4,p=4,h=3,g="",E=[],m={val:r(0),position:n,index:1};for(o=0;o<3;o+=1)d[o]=o;for(s=0,c=Math.pow(2,2),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;l=e(s);break;case 1:for(s=0,c=Math.pow(2,16),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;l=e(s);break;case 2:return""}for(d[3]=l,i=l,E.push(l);;){if(m.index>t)return"";for(s=0,c=Math.pow(2,h),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;switch(l=s){case 0:for(s=0,c=Math.pow(2,8),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;d[p++]=e(s),l=p-1,f--;break;case 1:for(s=0,c=Math.pow(2,16),u=1;u!=c;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),s|=(a>0?1:0)*u,u<<=1;d[p++]=e(s),l=p-1,f--;break;case 2:return E.join("")}if(0==f&&(f=Math.pow(2,h),h++),d[l])g=d[l];else{if(l!==p)return null;g=i+i.charAt(0)}E.push(g),d[p++]=i+g.charAt(0),i=g,0==--f&&(f=Math.pow(2,h),h++)}}};return i}();void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)},486:e=>{!function(t){"use strict";"function"===typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,n=R(),r=function(){},o=function(){var e={task:void 0,next:null},t=e,n=!1,r=void 0,i=!1,s=[];function a(){for(var t,r;e.next;)t=(e=e.next).task,e.task=void 0,(r=e.domain)&&(e.domain=void 0,r.enter()),c(t,r);for(;s.length;)c(t=s.pop());n=!1}function c(e,t){try{e()}catch(e){if(i)throw t&&t.exit(),setTimeout(a,0),t&&t.enter(),e;setTimeout((function(){throw e}),0)}t&&t.exit()}if(o=function(e){t=t.next={task:e,domain:i&&process.domain,next:null},n||(n=!0,r())},"object"===typeof process&&"[object process]"===process.toString()&&process.nextTick)i=!0,r=function(){process.nextTick(a)};else if("function"===typeof setImmediate)r="undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){r=l,u.port1.onmessage=a,a()};var l=function(){u.port2.postMessage(0)};r=function(){setTimeout(a,0),l()}}else r=function(){setTimeout(a,0)};return o.runAfter=function(e){s.push(e),n||(n=!0,r())},o}(),i=Function.call;function s(e){return function(){return i.apply(e,arguments)}}var a,c=s(Array.prototype.slice),u=s(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),l=s(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=s(Array.prototype.map||function(e,t){var n=this,r=[];return u(n,(function(o,i,s){r.push(e.call(t,i,s,n))}),void 0),r}),f=Object.create||function(e){function t(){}return t.prototype=e,new t},p=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},h=s(Object.prototype.hasOwnProperty),g=Object.keys||function(e){var t=[];for(var n in e)h(e,n)&&t.push(n);return t},E=s(Object.prototype.toString);function m(e){return"[object StopIteration]"===E(e)||e instanceof a}a="undefined"!==typeof ReturnValue?ReturnValue:function(e){this.value=e};function _(t,n){if(e&&n.stack&&"object"===typeof t&&null!==t&&t.stack){for(var r=[],o=n;o;o=o.source)o.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>o.stackCounter)&&(p(t,"__minimumStackCounter__",{value:o.stackCounter,configurable:!0}),r.unshift(o.stack));r.unshift(t.stack);var i=function(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var o=t[r];w(o)||y(o)||!o||n.push(o)}return n.join("\n")}(r.join("\nFrom previous event:\n"));p(t,"stack",{value:i,configurable:!0})}}function y(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function I(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function w(e){var r=I(e);if(!r)return!1;var o=r[0],i=r[1];return o===t&&i>=n&&i<=Y}function R(){if(e)try{throw new Error}catch(e){var n=e.stack.split("\n"),r=I(n[0].indexOf("@")>0?n[1]:n[2]);if(!r)return;return t=r[0],r[1]}}function T(e){return e instanceof k?e:P(e)?function(e){var t=A();return T.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):j(e)}T.resolve=T,T.nextTick=o,T.longStackSupport=!1;var O=1;function A(){var t,n=[],r=[],o=f(A.prototype),i=f(k.prototype);if(i.promiseDispatch=function(e,o,i){var s=c(arguments);n?(n.push(s),"when"===o&&i[1]&&r.push(i[1])):T.nextTick((function(){t.promiseDispatch.apply(t,s)}))},i.valueOf=function(){if(n)return i;var e=b(t);return S(e)&&(t=e),e},i.inspect=function(){return t?t.inspect():{state:"pending"}},T.longStackSupport&&e)try{throw new Error}catch(e){i.stack=e.stack.substring(e.stack.indexOf("\n")+1),i.stackCounter=O++}function s(o){t=o,T.longStackSupport&&e&&(i.source=o),u(n,(function(e,t){T.nextTick((function(){o.promiseDispatch.apply(o,t)}))}),void 0),n=void 0,r=void 0}return o.promise=i,o.resolve=function(e){t||s(T(e))},o.fulfill=function(e){t||s(j(e))},o.reject=function(e){t||s($(e))},o.notify=function(e){t||u(r,(function(t,n){T.nextTick((function(){n(e)}))}),void 0)},o}function v(e){if("function"!==typeof e)throw new TypeError("resolver must be a function.");var t=A();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function N(e){return v((function(t,n){for(var r=0,o=e.length;r<o;r++)T(e[r]).then(t,n)}))}function k(e,t,n){void 0===t&&(t=function(e){return $(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=f(k.prototype);if(r.promiseDispatch=function(n,o,i){var s;try{s=e[o]?e[o].apply(r,i):t.call(r,o,i)}catch(e){s=$(e)}n&&n(s)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function C(e,t,n,r){return T(e).then(t,n,r)}function b(e){if(S(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function S(e){return e instanceof k}function P(e){return(t=e)===Object(t)&&"function"===typeof e.then;var t}"object"===typeof process&&process&&process.env&&process.env.Q_DEBUG&&(T.longStackSupport=!0),T.defer=A,A.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(n)}},T.Promise=v,T.promise=v,v.race=N,v.all=W,v.reject=$,v.resolve=T,T.passByCopy=function(e){return e},k.prototype.passByCopy=function(){return this},T.join=function(e,t){return T(e).join(t)},k.prototype.join=function(e){return T([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)}))},T.race=N,k.prototype.race=function(){return this.then(T.race)},T.makePromise=k,k.prototype.toString=function(){return"[object Promise]"},k.prototype.then=function(e,t,n){var r=this,o=A(),i=!1;return T.nextTick((function(){r.promiseDispatch((function(t){i||(i=!0,o.resolve(function(t){try{return"function"===typeof e?e(t):t}catch(e){return $(e)}}(t)))}),"when",[function(e){i||(i=!0,o.resolve(function(e){if("function"===typeof t){_(e,r);try{return t(e)}catch(e){return $(e)}}return $(e)}(e)))}])})),r.promiseDispatch(void 0,"when",[void 0,function(e){var t,r=!1;try{t=function(e){return"function"===typeof n?n(e):e}(e)}catch(e){if(r=!0,!T.onerror)throw e;T.onerror(e)}r||o.notify(t)}]),o.promise},T.tap=function(e,t){return T(e).tap(t)},k.prototype.tap=function(e){return e=T(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},T.when=C,k.prototype.thenResolve=function(e){return this.then((function(){return e}))},T.thenResolve=function(e,t){return T(e).thenResolve(t)},k.prototype.thenReject=function(e){return this.then((function(){throw e}))},T.thenReject=function(e,t){return T(e).thenReject(t)},T.nearer=b,T.isPromise=S,T.isPromiseAlike=P,T.isPending=function(e){return S(e)&&"pending"===e.inspect().state},k.prototype.isPending=function(){return"pending"===this.inspect().state},T.isFulfilled=function(e){return!S(e)||"fulfilled"===e.inspect().state},k.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},T.isRejected=function(e){return S(e)&&"rejected"===e.inspect().state},k.prototype.isRejected=function(){return"rejected"===this.inspect().state};var L,D,U,G=[],x=[],F=[],M=!0;function V(){G.length=0,x.length=0,M||(M=!0)}function $(e){var t=k({when:function(t){return t&&function(e){if(M){var t=l(x,e);-1!==t&&("object"===typeof process&&"function"===typeof process.emit&&T.nextTick.runAfter((function(){var n=l(F,e);-1!==n&&(process.emit("rejectionHandled",G[t],e),F.splice(n,1))})),x.splice(t,1),G.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){M&&("object"===typeof process&&"function"===typeof process.emit&&T.nextTick.runAfter((function(){-1!==l(x,e)&&(process.emit("unhandledRejection",t,e),F.push(e))})),x.push(e),t&&"undefined"!==typeof t.stack?G.push(t.stack):G.push("(no stack) "+t))}(t,e),t}function j(e){return k({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return g(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function B(e,t,n){return T(e).spread(t,n)}function q(e,t,n){return T(e).dispatch(t,n)}function W(e){return C(e,(function(e){var t=0,n=A();return u(e,(function(r,o,i){var s;S(o)&&"fulfilled"===(s=o.inspect()).state?e[i]=s.value:(++t,C(o,(function(r){e[i]=r,0===--t&&n.resolve(e)}),n.reject,(function(e){n.notify({index:i,value:e})})))}),void 0),0===t&&n.resolve(e),n.promise}))}function K(e){if(0===e.length)return T.resolve();var t=T.defer(),n=0;return u(e,(function(r,o,i){var s=e[i];n++,C(s,(function(e){t.resolve(e)}),(function(e){if(0===--n){var r=e||new Error(""+e);r.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+r.message,t.reject(r)}}),(function(e){t.notify({index:i,value:e})}))}),void 0),t.promise}function H(e){return C(e,(function(e){return e=d(e,T),C(W(d(e,(function(e){return C(e,r,r)}))),(function(){return e}))}))}T.resetUnhandledRejections=V,T.getUnhandledReasons=function(){return G.slice()},T.stopUnhandledRejectionTracking=function(){V(),M=!1},V(),T.reject=$,T.fulfill=j,T.master=function(e){return k({isDef:function(){}},(function(t,n){return q(e,t,n)}),(function(){return T(e).inspect()}))},T.spread=B,k.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},T.async=function(e){return function(){function t(e,t){var i;if("undefined"===typeof StopIteration){try{i=n[e](t)}catch(e){return $(e)}return i.done?T(i.value):C(i.value,r,o)}try{i=n[e](t)}catch(e){return m(e)?T(e.value):$(e)}return C(i,r,o)}var n=e.apply(this,arguments),r=t.bind(t,"next"),o=t.bind(t,"throw");return r()}},T.spawn=function(e){T.done(T.async(e)())},T.return=function(e){throw new a(e)},T.promised=function(e){return function(){return B([this,W(arguments)],(function(t,n){return e.apply(t,n)}))}},T.dispatch=q,k.prototype.dispatch=function(e,t){var n=this,r=A();return T.nextTick((function(){n.promiseDispatch(r.resolve,e,t)})),r.promise},T.get=function(e,t){return T(e).dispatch("get",[t])},k.prototype.get=function(e){return this.dispatch("get",[e])},T.set=function(e,t,n){return T(e).dispatch("set",[t,n])},k.prototype.set=function(e,t){return this.dispatch("set",[e,t])},T.del=T.delete=function(e,t){return T(e).dispatch("delete",[t])},k.prototype.del=k.prototype.delete=function(e){return this.dispatch("delete",[e])},T.mapply=T.post=function(e,t,n){return T(e).dispatch("post",[t,n])},k.prototype.mapply=k.prototype.post=function(e,t){return this.dispatch("post",[e,t])},T.send=T.mcall=T.invoke=function(e,t){return T(e).dispatch("post",[t,c(arguments,2)])},k.prototype.send=k.prototype.mcall=k.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},T.fapply=function(e,t){return T(e).dispatch("apply",[void 0,t])},k.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},T.try=T.fcall=function(e){return T(e).dispatch("apply",[void 0,c(arguments,1)])},k.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},T.fbind=function(e){var t=T(e),n=c(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(c(arguments))])}},k.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},T.keys=function(e){return T(e).dispatch("keys",[])},k.prototype.keys=function(){return this.dispatch("keys",[])},T.all=W,k.prototype.all=function(){return W(this)},T.any=K,k.prototype.any=function(){return K(this)},T.allResolved=(L=H,D="allResolved",U="allSettled",function(){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(D+" is deprecated, use "+U+" instead.",new Error("").stack),L.apply(L,arguments)}),k.prototype.allResolved=function(){return H(this)},T.allSettled=function(e){return T(e).allSettled()},k.prototype.allSettled=function(){return this.then((function(e){return W(d(e,(function(e){function t(){return e.inspect()}return(e=T(e)).then(t,t)})))}))},T.fail=T.catch=function(e,t){return T(e).then(void 0,t)},k.prototype.fail=k.prototype.catch=function(e){return this.then(void 0,e)},T.progress=function(e,t){return T(e).then(void 0,void 0,t)},k.prototype.progress=function(e){return this.then(void 0,void 0,e)},T.fin=T.finally=function(e,t){return T(e).finally(t)},k.prototype.fin=k.prototype.finally=function(e){if(!e||"function"!==typeof e.apply)throw new Error("Q can't apply finally callback");return e=T(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},T.done=function(e,t,n,r){return T(e).done(t,n,r)},k.prototype.done=function(e,t,n){var r=function(e){T.nextTick((function(){if(_(e,o),!T.onerror)throw e;T.onerror(e)}))},o=e||t||n?this.then(e,t,n):this;"object"===typeof process&&process&&process.domain&&(r=process.domain.bind(r)),o.then(void 0,r)},T.timeout=function(e,t,n){return T(e).timeout(t,n)},k.prototype.timeout=function(e,t){var n=A(),r=setTimeout((function(){t&&"string"!==typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)}),e);return this.then((function(e){clearTimeout(r),n.resolve(e)}),(function(e){clearTimeout(r),n.reject(e)}),n.notify),n.promise},T.delay=function(e,t){return void 0===t&&(t=e,e=void 0),T(e).delay(t)},k.prototype.delay=function(e){return this.then((function(t){var n=A();return setTimeout((function(){n.resolve(t)}),e),n.promise}))},T.nfapply=function(e,t){return T(e).nfapply(t)},k.prototype.nfapply=function(e){var t=A(),n=c(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},T.nfcall=function(e){var t=c(arguments,1);return T(e).nfapply(t)},k.prototype.nfcall=function(){var e=c(arguments),t=A();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},T.nfbind=T.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=c(arguments,1);return function(){var n=t.concat(c(arguments)),r=A();return n.push(r.makeNodeResolver()),T(e).fapply(n).fail(r.reject),r.promise}},k.prototype.nfbind=k.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),T.denodeify.apply(void 0,e)},T.nbind=function(e,t){var n=c(arguments,2);return function(){var r=n.concat(c(arguments)),o=A();function i(){return e.apply(t,arguments)}return r.push(o.makeNodeResolver()),T(i).fapply(r).fail(o.reject),o.promise}},k.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),T.nbind.apply(void 0,e)},T.nmapply=T.npost=function(e,t,n){return T(e).npost(t,n)},k.prototype.nmapply=k.prototype.npost=function(e,t){var n=c(t||[]),r=A();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},T.nsend=T.nmcall=T.ninvoke=function(e,t){var n=c(arguments,2),r=A();return n.push(r.makeNodeResolver()),T(e).dispatch("post",[t,n]).fail(r.reject),r.promise},k.prototype.nsend=k.prototype.nmcall=k.prototype.ninvoke=function(e){var t=c(arguments,1),n=A();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},T.nodeify=function(e,t){return T(e).nodeify(t)},k.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){T.nextTick((function(){e(null,t)}))}),(function(t){T.nextTick((function(){e(t)}))}))},T.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var Y=R();return T}))}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(698);if(!!!window.Promise){const e="This browser is not supported by OneID because it does not honor Promise.";throw console.warn(e),new Error(e)}Object.fromEntries=Object.fromEntries||e.m8})(),(()=>{"use strict";const e={ERROR:5,WARN:4,INFO:3,DEBUG:2,LOG:1,OFF:100};let t=e.INFO,r=!1;const o={ERROR:"color:#FC0C1B;background-color:#FFEFEF",WARN:"color:#5B3A06;background-color:#FFFBE6",INFO:"color:#363F47;background-color:#e1e9ff",DEBUG:"color:#444;background-color:#eee",LOG:"color:#000;background-color:transparent",DEFAULT:"color:#000;background-color:transparent;font-weight:",ONEID:"color:#2887b4;background-color:transparent;font-weight:bold"};let i=c();function s(e){"number"===typeof e&&(t=e,i=c())}function a(n){return t>e[n]?(e="",t={})=>{}:r?function(e){const t=["%c[OneID]%c %c[%s]%c: ",o.ONEID,o.DEFAULT,o[e],e,o.DEFAULT];return window.console[e.toLowerCase()].bind(window.console,...t)}(n):function(e){return window.console[e.toLowerCase()].bind(window.console,"[OneID] [%s]: ",e)}(n)}function c(){return{error:a("ERROR"),warn:a("WARN"),info:a("INFO"),debug:a("DEBUG"),log:a("LOG")}}var u=n(698);const l=/^\.?www/,d=/^(.+)@([a-z0-9-]+)(\.([a-z]+))+$/i,f=/^[a-z]{2}-[A-Z]{2}$/,p=/LOGIN_FLOW|RECOVERY_FLOW|CONTACT_CSR_FLOW/i,h="oid_loglevel";function g(e){return e&&document.cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${e}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1")||null}function E(e,t,n){if(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?`; domain=${t}`:"")+(n?`; path=${n}`:""),t&&!l.test(t)){const r=`www${/^\./.test(t)?"":"."}${t}`;i.debug(`also deleting cookie from ${r}`),E(e,r,n)}return!0}function m(e,t,n,r,o,s){let a,c=!1;if(l.test(n)&&(n=n.replace(l,""),c=!0),!e||/^(?:expires|max-age|path|domain|secure)$/i.test(e))return!1;if(a=`${e}=${t}`,o&&o instanceof Date&&(a+=`; expires=${o.toUTCString()}`),n&&(a+=`; domain=${n}`),r&&(a+=`; path=${r}`),s&&(a+="; secure"),document.cookie=a,c){const t=`www${/^\./.test(n)?"":"."}${n}`;i.debug(`calling delete on domain ${t}`),E(e,t,r||"")}return!0}const _={getCookieDomain:function(){const e=(0,u.KT)(window.location.hostname);return e?"."+e:".go.com"}};function y(e,t){let n=new Date(e);return isNaN(parseInt(t,10))||t<0||!(e instanceof Date)?null:(n.setSeconds(e.getSeconds()+t),n)}const I={};function w(){return I}function R(e,t){Array.isArray(I[e])||(I[e]=[]),I[e].push(t)}function T(e,t){if(Array.isArray(I[e]))if("undefined"!==typeof t)for(let n=0;n<I[e].length;n++)I[e][n]===t&&I[e].splice(n,1);else I[e]=[]}function O(e,t){const n=w();Array.isArray(n[e])&&n[e].forEach((e=>{try{e(t)}catch(e){}}))}function A(e,t,n,r,o){return{status:e,response:t,statusText:r,headers:(i=n,(i||"").split("\n").map((e=>{const t=e.indexOf(":")||0;return[e.substr(0,t).trim(),e.substr(t+1).trim()]})).filter((e=>!!e[0])).reduce(((e,t)=>{const[n,r]=t;return{[n]:r,...e}}),{})),debug:{xhrFailureReason:o}};var i}function v(e,t,n,r,o){return new Promise((i=>{const s=new XMLHttpRequest;let a;s.open(e,t,!0),Object.keys(r||{}).forEach((e=>{const t=r[e];"undefined"!==typeof t&&s.setRequestHeader((e||"").toLowerCase(),t)})),s.onload=()=>{clearTimeout(a),i(function(e){const t=e.statusText||"",n="response"in e?e.response:e.responseText,r=e.getAllResponseHeaders();let{status:o}=e;return 0===o&&(o=n?200:0),A(o,n,r,t)}(s))},s.onabort=()=>{clearTimeout(a),i(A(-1,null,null,"","onabort"))},s.onerror=()=>{clearTimeout(a),i(A(-1,null,null,"","onerror"))},s.send("undefined"!==n?n:null),"number"===typeof o&&o>0&&(a=setTimeout((()=>{i(A(-1,null,null,"","setTimeout"))}),o))}))}function N(e){const t=e||{},{responseData:n,headers:r,status:o}=function(e){let t;try{t={...JSON.parse(e.response)}}catch(e){t={}}return{responseData:t,headers:e.headers||{},status:e.status||-1}}(e),i=n.data||n||null,s=n.error||null,a=-1===o,c=!a&&!!s,u=a||c,{debug:l}=t,d={status:o,data:i,error:s,headers:r,isError:u,isNetworkError:a,isAppError:c,debug:l};if(a)throw d;return d}function k(e){let{url:t}=e.request;const{method:n,body:r,headers:o,query:i,timeoutMs:s}=e.request,a=function(e={}){const t=[];return Object.keys(e).forEach((n=>{Array.isArray(e[n])?e[n].forEach((e=>{t.push([n,e])})):t.push([n,e[n]])})),t.map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(i);return a&&(t+=`?${a}`),v(n,t,JSON.stringify(r),o,s).then((t=>Object.assign(e,{response:N(t)})))}function C(e,t){const n=this[e];if("function"!==typeof t)throw new Error("Mutator must be a function");-1===n.indexOf(t)&&n.push(t)}function b(e){return async t=>{const n=await e(t);return void 0===n?t:n}}function S(e,...t){const n=e(...t),r=this.request,o=this.response;let i=Promise.resolve({request:n,response:null});r.forEach((e=>{i=i.then(b(e))}));let s=i.then(k);return o.forEach((e=>{s=s.then(b(e))})),s.then((e=>e.response))}function P(e){const t={request:[],response:[]},n={};return Object.keys(e).forEach((r=>{n[r]=S.bind(t,e[r])})),n.addRequestMutator=C.bind(t,"request"),n.addResponseMutator=C.bind(t,"response"),n}let L;const D={langPref:"en-US",cssOverride:""};function U(){return L}const G="ac",x="api",F="idn",M="mtx",V="s2",$="SWID",j="SWID_NT",B="token",q="ts";function W(e,t=!1){if(!e)return;const n=new Date(Date.now());n.setFullYear(n.getFullYear()+1),m($,e,_.getCookieDomain(),"/",n),t&&m(j,1,_.getCookieDomain(),"/",n)}function K(){return g($)}const H=/^{?[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}}?$/,Y="|",z="=",Q="#",X="$",Z="-",J="string",ee="date",te="int",ne="boolean",re="uuid",oe="json",ie="string_raw",se={currentVersion:"5",versions:{4:[{key:"token.access_token",type:J},{key:"token.swid",type:re},{key:"token.refresh_token",type:J},{key:"token.ttl",type:te},{key:"token.refresh_ttl",type:te},{key:"token.sso",type:re},{key:"token.created",type:J},{key:"token.lastChecked",type:J},{key:"token.expires",type:J},{key:"token.refresh_expires",type:J},{key:"token.authenticator",type:J},{key:"token.blue_cookie",type:J},{key:"token.high_trust_expires_in",type:te},{key:"token.initial_grant_in_chain_time",type:te},{key:"token.id_token",type:J},{key:"token.sessionTransferKey",type:J}],5:[{key:"token",type:oe},{key:"id_token",type:ie}]},vals:{4:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~",5:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~"}};function ae(e,t=se.currentVersion){const n=se.versions[t];if(!n)return;const r={token:(0,u.d9)(e.token),id_token:e.token.id_token};return delete r.token.id_token,delete r.token.scope,t+z+function(e,t){return t.map((t=>function(e,t){let n,r=se.vals[se.currentVersion];if(!e||!t||!t.key||!t.type)return;if(n=(0,u.U2)(e,t.key),"undefined"===typeof n||null===n)return;switch(t.type){case J:n=a(n);break;case ee:n=c(n);break;case te:n=i(n);break;case ne:n=d(n);break;case re:n=l(n);break;case ie:break;case oe:n=o(n);break;default:n=a(n)}return n;function o(e){return"object"!==typeof e?e:(0,u.h$)(JSON.stringify(e))}function i(e){let t="";if(e=parseInt(e,10),!isNaN(e)){if(0===e)return r.charAt(0);for(e<0&&(t=Z,e*=-1);e>0;){let n=Math.floor(e/r.length),o=e-n*r.length;t+=r.charAt(o),e=n}return t}}function s(e,t){for(let n=0;n<t;n++)e+=r.charAt(0);return e}function a(e){let t,n="";if("undefined"!==typeof e&&null!==e)return(""+e).split("").forEach((e=>{t=i(e.charCodeAt()-32),2===t.length?t=Q+t:3===t.length&&(t=X+t),n+=t})),n}function c(e){return"[object Date]"!==Object.prototype.toString.call(e)&&(e=new Date(e)),i(e.getTime())}function l(e){let t,n="",o="",c=8;if("[object String]"!==Object.prototype.toString.call(e)||!H.test(e))return a(e);o+=/^{[^}]*}$/.test(e)?"1":"0",o+=/[A-F]/.test(e)?"1":"0",e=e.replace(/[{\-}]/g,""),t=Math.floor(e.length/c);for(let r=0;r<t;r++){let t=e.substr(r*c,c),o=i(parseInt(t,16));n+=s(o,6-o.length)}return""+r.charAt(parseInt(o,2))+n}function d(e){if("true"===e||"1"===e||!0===e||1===e)e=1;else{if("false"!==e&&"0"!==e&&!1!==e&&0!==e)return;e=0}return i(e)}}(e,t))).join(Y)}(r,n)}function ce(e){if(!e)return;const t=e.substring(e.indexOf(z)+1),n=e.substring(0,e.indexOf(z)),r=se.versions[n];if(!r)return;const o=function(e,t,n){const r={};return e.split("|").forEach(((e,o)=>{(0,u.t8)(r,t[o].key,function(e,t,n){if(""===e)return null;const r=se.vals[n]||se.vals[se.currentVersion];switch(t.type){case J:e=s(e);break;case ee:e=a(e);break;case te:e=i(e);break;case ne:e=l(e);break;case re:e=c(e);break;case ie:break;case oe:e=o(e)}return e;function o(e){let t;try{const n=(0,u.tV)(e);t=JSON.parse(n)}catch(t){return e}return t}function i(e){let t=0,n=1,o=1;if(0!==(e=(e||"").split("")).length)return e[0]===Z&&(n=-1,e.splice(0,1)),e.forEach((e=>{t+=r.indexOf(e)*o,o*=r.length})),t*n}function s(e){let t,n=0,r=e.length,o="";if(0!==r){for(;n<r;){switch(e[n]){case Q:t=2,n++;break;case X:t=3,n++;break;default:t=1}o+=String.fromCharCode(i(e.substr(n,t))+32),n+=t}return o}}function a(e){if(e=i(e))return new Date(e)}function c(e){let t,n=parseInt(r.indexOf(e[0]),10),o=!1,a=!1,c="",u=6,l=e;isNaN(n)||(n=n.toString(2),n.length<2&&(n="0"+n),o="1"===n[0],a="1"===n[1],e=e.substring(1)),t=Math.floor(e.length/u);for(let n=0;n<t;n++){let t=i(e.substr(n*u,u)).toString(16);for(;t.length<8;)t="0"+t;c+=t}c=a?c.toUpperCase():c.toLowerCase();let d=(o?"{":"")+c.substring(0,8)+"-"+c.substring(8,12)+"-"+c.substring(12,16)+"-"+c.substring(16,20)+"-"+c.substring(20)+(o?"}":"");return H.test(d)?d:s(l)}function l(e){return 1===i(e)}}(e,t[o],n))})),r}(t,r,n),i=o.token;i.id_token=o.id_token;let s=!1;if(i.expires){const e=new Date(i.expires).getTime();s=!("string"===typeof(a=i).access_token&&"string"===typeof a.swid&&"number"===typeof a.ttl)||isNaN(e)||e<(new Date).getTime()}var a;return i.isExpired=s,i}function ue(e,t=3e4){const n=Object.keys(e.frames).reduce(((t,n)=>({...t,[n]:{name:n,window:e.frames[n].window,ports:{},origin:e.frames[n].origin}})),{}),r=[];return Object.keys(e.frames).forEach((t=>{const r=n[t];e.frames[t].channels.forEach((e=>{const o=n[e];if(!r.ports[e]){const n=new MessageChannel;r.ports[e]=n.port1,o.ports[t]=n.port2}}))})),Object.keys(n).forEach((e=>{var o;r.push(function(e,t){return new Promise(((n,r)=>{const o=Date.now(),i=setInterval(s,100);function s(){if(Date.now()-o>t)return c(),void r(new Error("Bootstrap timed out"));e.window.postMessage({event:"comm-bootstrap-start",targetName:e.name},e.origin)}function a(t){const r=t.data&&t.data.targetName;t.source===e.window&&r&&r===e.name&&t.data&&"comm-bootstrap-ack"===t.data.event&&(c(),n())}function c(){clearInterval(i),window.removeEventListener("message",a)}window.addEventListener("message",a),s()}))}(n[e],t).then((o=n[e],()=>{const e=Object.keys(o.ports);for(const t of e)o.window.postMessage({event:"comm-bootstrap-data",targetName:o.name,ports:e,port:t},o.origin,[o.ports[t]])})))})),Promise.all(r)}const le=["CALL","CALL_DONE","EVENT"];function de(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_=+";let t="";for(let n=0;n<24;n+=1){t+=e[Math.floor(Math.random()*e.length)]}return t}function fe(e,t="DEFAULT"){const n=`PatchBay[${t}]`,r={},o={},s={};return Object.keys(e).forEach((t=>{e[t].onmessage=function(e){return t=>{if(!t||!t.data||"object"!==typeof t.data)return;const n=t.data;-1!==le.indexOf(n.type)&&(a(n.name,e,n),setTimeout(c.bind(null,n.name)))}}(t)})),{addHandler:function(e,t){if("function"!==typeof t)return;r[e]=t,c(e)},message:l,broadcast:function(t,n){const r={id:de(),type:"EVENT",data:n,name:t};a(t,null,r),setTimeout(c.bind(null,t)),Object.keys(e).forEach((e=>{l(e,t,n)}))},call:function(e,t,r){return new Promise(((o,a)=>{let c=de();i.debug(`${n}: call() invoked, target=${e}, name=${t}, id=${c}`),s[c]={resolve:o,reject:a},d(e,t,"CALL",r,c)}))}};function a(e,t,r){i.debug(`${n}: queueMessage(name=${e}, source=${t})`),o[e]||(o[e]=[]),o[e].push({source:t,data:r})}function c(e){if(i.debug(`${n}: flushQueue(name=${e})`),!Array.isArray(o[e])||o[e].length<1)return void i.debug(`${n}: Nothing in queue for '${e}', exit early`);const t=[];for(;o[e].length;){const{source:a,data:c}=o[e].pop(),l=c&&c.type||void 0,d=c&&c.id||void 0,f=`${n} - ${d||"NO_ID"}`;if(i.debug(`${f}: flushQueue loop, source=${a}, type=${l}`),"CALL"===l||"EVENT"===l){let n;if(!r[e]){i.debug(`${f}: flushQueue loop, NO HANDLER FOR name=${e}, deferring`),t.push({source:a,data:c});continue}i.debug(`${f}: flushQueue loop, about to call handler for name=${e}`),n=r[e](c&&c.data),i.debug(`${f}: flushQueue loop, obtained return value from name=${e}`),"CALL"===l&&(n&&n.then||(i.debug(`${f}: flushQueue loop, handler for name=${e} returned plain value`),n=Promise.resolve(n)),n.then((t=>{i.debug(`${f}: flushQueue, promise resolved for name=${e}, messaging back`),u(a,e,t,d,"resolved")})).catch((t=>{i.debug(`${f}: flushQueue, promise caught error for name=${e}, messaging back`),u(a,e,t,d,"rejected")})))}if("CALL_DONE"===l){const e=c.status;if(!s[d]){i.debug(`${f}: flushQueue loop, pendingCalls EMPTY FOR id=${d}!!!`);continue}"resolved"===e?(i.debug(`${f}: flushQueue loop, resolving promise for id=${d}`),s[d].resolve(c.data)):(i.debug(`${f}: flushQueue loop, rejecting promise for id=${d}`),s[d].reject(c.data)),delete s[d]}}for(let r of t)i.debug(`${n}: flushQueue, pushing deferred item back into queue, name=${e}`),o[e].push(r)}function u(e,t,n,r,o){d(e,t,"CALL_DONE",n,r,o)}function l(e,t,n){d(e,t,"EVENT",n)}function d(r,o,s,u,l,d){if(l=l||de(),r===t)return i.debug(`${n}: Target is self...`),a(o,r,{id:l,type:s,name:o,data:u,status:d}),void setTimeout(c.bind(null,o));e[r]?e[r].postMessage({id:l,type:s,name:o,data:u,status:d}):i.debug(`${n}: Target '${r}' has not been registered!!!`)}}const pe=(he="outer",new Promise((e=>{const t={};window.addEventListener("message",(function n(r){r.data&&r.data.targetName===he&&("comm-bootstrap-start"===r.data.event&&r.source.postMessage({event:"comm-bootstrap-ack",targetName:he},"*"),"comm-bootstrap-data"===r.data.event&&(t[r.data.port]=r.ports[0],Object.keys(t).length>=r.data.ports.length&&(window.removeEventListener("message",n),e(t))))}))}))).then((e=>new fe(e,"outer")));var he;const ge=/^stg-|-stg\.|^stg.cdn/,Ee=/^qa-|-qa\.|:3001$|^qa.cdn/,me="QA",_e="STAGE";let ye="PROD",Ie="";function we(){return ye}const Re=216e5,Te=3e4,Oe=33,Ae=5,ve=5e3,Ne=2e4,ke=1e4,Ce=18e5;function be(){const e=U(),t=we();return pe.then((n=>n.call("responder","get.cookie",`${e&&e.clientId}-${t}.${B}`).then((e=>ce(e))).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`)}))))}var Se=n(961);const Pe=[];function Le(){if(!Pe.length)return"";let e=Pe.join("|");return e.length>600&&(e=e.slice(-600)),`0|${(0,Se.compressToBase64)(e)}`}function De(e,t,n,r){let o;const s=`WorkflowManager[${e}]: `;return{runWorkflow:function(){i.debug(s+"WorkflowManager.runWorkflow"),i.debug(s+"name :",e),o=n||Object.keys(t[0])[0],i.debug(s+"step :",o),c()}};function a(){const e=t.find((e=>Object.keys(e)[0]===o));return e&&e[o]}function c(){var t;i.debug(`${s}Executing step ${o}`),t=`${e.toUpperCase()}>${o}`,Pe.push(t);const n=a(),r=Object.keys(n.results);try{n.stepExecution(u,r)}catch(e){throw i.error(e),e}}function u(t){i.debug(`${s}Step complete, result ${t}`);const{results:n}=a()||{};if(o=n&&n[t],o)return c();i.debug(s+"Workflow complete:",e),r&&r(t)}}const Ue={ACTION_NAME:"action_name",ERROR_CATEGORY:"error_category",ERROR_CODES:"error_codes",FLOW:"flow",SUBFLOW:"subflow",INFO:"info",NEW_RELIC:"newRelic",PAGE_VIEW:"pageView",PROBLEM:"problem",STACK_TRACE:"stack_trace",TRANSACTION_ID:"transaction_id",API_FORCE_TOKEN_REFRESH:"api:force:tokenrefresh",API_GET_ACTIVITY_STATUS:"api:get:activitystatus",API_GET_GUEST_DATA:"api:get:guest",API_GET_GUEST_NEWSLETTERS:"api:get:guestnewsletters",API_GET_INLINE_NEWSLETTERS:"api:get:inlinenewsletters",API_GET_LICENSE_PLATE_DATA_BAG:"api:get:licenseplate:databag",API_GET_LOGGED_IN_STATUS:"api:get:loggedinstatus",API_GET_TRUST_STATE_STATUS:"api:get:truststatestatus",API_INIT:"api:init",API_LAUNCH_EMAILVERIFICATION:"api:launch:emailverification",API_LAUNCH_GUESTFLOW:"api:launch:guestflow",API_LAUNCH_IDENTITYFLOW:"api:launch:identityflow",API_LAUNCH_LICENSE_PLATE:"api:launch:licenseplate",API_LAUNCH_LOGIN:"api:launch:login",API_LAUNCH_NEWSLETTERS:"api:launch:newsletters",API_LAUNCH_PROFILE:"api:launch:profile",API_LAUNCH_REAUTH:"api:launch:reauth",API_LAUNCH_REGISTRATION:"api:launch:registration",API_LAUNCH_SOCIAL_REGISTRATION:"api:launch:socialregistration",API_LOGOUT:"api:logout",API_REDEEM_LICENSE_PLATE_CODE:"api:redeem:licenseplate:code",API_SET_DO_NOT_DISTURB:"api:set:donotdisturb",API_SET_INLINE_NEWSLETTERS:"api:set:inlinenewsletters",API_GET_PPC:"api:get:ppc",API_SET_PPC:"api:set:ppc",EVENT_CLOSE:"event:ui:close",EVENT_LOGOUT:"event:logout",EVENT_AGE_GATED:"event:agegated",EVENT_CREATE:"event:create",EVENT_ERROR:"event:error",EVENT_EXPIRED_SESSION:"event:expiredsession",EVENT_INIT:"event:init",EVENT_LOGIN:"event:login",EVENT_LOW_TRUST:"event:lowtrust",EVENT_OPT_IN:"event:optin",EVENT_REAUTH:"event:reauth",EVENT_REFRESH:"event:refresh",EVENT_UPDATE:"event:update",BU_EVENT_TO_ACTION_NAME:{"age-gated":"EVENT_AGE_GATED",close:"EVENT_CLOSE",create:"EVENT_CREATE",error:"EVENT_ERROR",init:"EVENT_INIT",login:"EVENT_LOGIN",logout:"EVENT_LOGOUT","low-trust":"EVENT_LOW_TRUST","opt-in":"EVENT_OPT_IN",reauth:"EVENT_REAUTH",refresh:"EVENT_REFRESH",update:"EVENT_UPDATE"},CLICK_PASSWORD_CHECK_RESET_PASSWORD:"click:passwordcheck:resetpassword",CLICK_PASSWORD_CHECK_SKIP_RESET:"click:passwordcheck:skipreset",CLICK_REGISTER_BUTTON_ON_LOGIN:"click:button:login:createaccount",CLICK_LOGIN_LINK_ON_REGISTER:"click:link:register:signin",LOG_APPLICATION_ERROR:"log:application:error",LOG_INVALID_DISPLAY_OPTION:"log:invalid:displayoption",LOG_INVALID_LEGAL_CONFIG:"log:invalid:legalconfig",LOG_INVALID_MARKETING_CONFIG:"log:invalid:marketingconfig",LOG_INVALID_OID_CONFIG:"log:invalid:oidconfig",LOG_MISSING_GUEST_DATA_ON_LOGOUT:"log:missing:guestdata:on:logout",LOG_MISSING_L10N:"log:missing:l10n",LOG_PATCHBAY_ERROR:"log:patchbay:error",LOG_UNID_INIT:"log:init:unid",LOG_VERSION_MISMATCH:"log:version:mismatch",SERVICE_CREATE:"service:register",SERVICE_DATE_OF_BIRTH_VALIDATE:"service:dob:validate",SERVICE_DISPLAY_NAME_VALIDATE:"service:displayname:validate",SERVICE_DOWNLOAD_CONFIG:"service:download:config",SERVICE_EMAIL_VALIDATE:"service:email:validate",SERVICE_GUEST_FLOW:"service:guestflow",SERVICE_LICENSE_PLATE_PEEK:"service:licenseplate:peek",SERVICE_LICENSE_PLATE_REDEEM:"service:licenseplate:redeem",SERVICE_LOGIN:"service:login",SERVICE_LOGIN_RECOVERY:"service:login:recovery",SERVICE_LOGOUT:"service:logout",SERVICE_NEWSLETTERS_GALC:"service:newsletters:galc",SERVICE_NEWSLETTERS_GEOGATED:"service:newsletters:geogated",SERVICE_OTP_EMAIL_VERIFICATION:"service:otprequest:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_REDEEM:"service:otpredeem:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_RESEND:"service:otprequest:emailverification:resend",SERVICE_OTP_EMAIL_UPDATE:"service:otprequest:update:email",SERVICE_OTP_EMAIL_UPDATE_REDEEM:"service:otpredeem:update:email",SERVICE_OTP_EMAIL_UPDATE_RESEND:"service:otprequest:update:email:resend",SERVICE_OTP_LOGIN_RECOVERY_METHODS:"service:otplogin:recovery:methods",SERVICE_OTP_LOGIN_REDEEM:"service:otpredeem",SERVICE_OTP_LOGIN_REQUEST_OTP:"service:otprecovery",SERVICE_OTP_LOGIN_RESEND_EMAIL:"service:otplogin:resend:email",SERVICE_OTP_LOGIN_RESEND_SMS:"service:otplogin:resend:sms",SERVICE_OTP_LOGIN_RESET_PASSWORD:"service:otplogin:resetpassword",SERVICE_OTP_LOGIN_UPGRADE_NRT:"service:otplogin:upgradenrt",SERVICE_OTP_PASSWORD_UPDATE:"service:otprequest:update:password",SERVICE_OTP_PASSWORD_UPDATE_REDEEM:"service:otpredeem:update:password",SERVICE_OTP_PASSWORD_UPDATE_RESEND:"service:otprequest:update:password:resend",SERVICE_OTP_PHONE_VERIFICATION:"service:otprequest:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_REDEEM:"service:otpredeem:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_RESEND:"service:otprequest:phoneverification:resend",SERVICE_PASSWORD_VALIDATE:"service:password:validate",SERVICE_PPU_PROFILE:"service:update:ppu:profile",SERVICE_PPU_PASSWORD:"service:update:ppu:password",SERVICE_REAUTH:"service:reauth",SERVICE_RECAPTCHA_CHECKBOX:"service:recaptchacheckbox",SERVICE_REFRESH_GUEST:"service:refresh:guest",SERVICE_REFRESH_TOKEN:"service:refresh:token",SERVICE_REGISTRATION_AGEGATED:"service:registration:agegated",SERVICE_REGISTRATION_GALC:"service:registration:galc",SERVICE_REGISTRATION_PIL2_NOTIFY:"service:registration:pil2:notify",SERVICE_UPDATE_GUEST:"service:update:guest",SERVICE_UPDATE_GUEST_CREDENTIALS:"service:update:guestcredentials",SERVICE_UPDATE_MARKETING:"service:update:marketing",SERVICE_USERNAME_VALIDATE:"service:username:validate",ID_TOKEN_MASK_LENGTH:6},Ge={action_name:"string",alternateConfig:"string",anon:"string",appid:"string",browser:"string - added by Log.go service",client_id:"string",connection_type:"string",context:"string",conversation_id:"string",error_category:"string",error_codes:"string",experience:"string",flow:"string",id_token:"string",info:"string",os:"string - added by Log.go service",platform:"string - added by Log.go service",problem:"string",process_time:"string",referrer_host:"string - added by Log.go service",reporting:"string",sdk_version:"string",source:"string",stack_trace:"string",subflow:"string",swid:"string",timestamp:"string",trace:"string",transaction_id:"string",unid:"string",user_agent:"string - added by Log.go service"};const xe={appid:"DTCI-ONEID-UI"};let Fe;let Me=!1,Ve={},$e={},je=!0;function Be(){const{clientId:e,langPref:t,debug:n}=U()||{};xe.client_id=`${e}-${we()}`,xe.locale=t,xe.sdk_version=`web ${window.ONEID_WEB_SDK_VERSION}`,function(){const e="https://feet-stg.segds.engsvc.go.com/",t="https://log.go.com/",n=we();Fe=n!==me&&n!==_e?t:e}(),n&&n.experimentalFeatures&&(window.newRelicRequests=[],je=!1),Me=!0}function qe(e={}){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"optionalConfigs.experience");t&&!ze(t)&&(t=null),n&&!Qe(n)&&(i.warn("optionalConfigs.experience does not pass validation, values will be ignored"),n=null),$e=t||n?{reporting:t,...n&&{experience:n}}:{},$e.conversationId=(0,u.Vj)()}function We(){let e={...Ve.reporting,...$e.reporting};return ze(e)||(i.warn("Combined reporting config does not pass validation, values will be ignored"),e={...Ve.reporting}),e.experience=$e.experience||Ve.experience,e.conversationId=$e.conversationId,{optionalConfigs:{reporting:e}}}function Ke(e){Me||Be();const t=Date.now(),n={action_name:e};return{send:(e={})=>Ye({...n,...e,process_time:Date.now()-t||1})}}const He={[Ue.API_GET_ACTIVITY_STATUS]:2,[Ue.API_GET_GUEST_DATA]:2,[Ue.API_GET_GUEST_NEWSLETTERS]:2,[Ue.API_GET_LOGGED_IN_STATUS]:2,[Ue.API_GET_TRUST_STATE_STATUS]:2,[Ue.API_INIT]:2,[Ue.API_SET_DO_NOT_DISTURB]:2,[Ue.EVENT_CLOSE]:50,[Ue.EVENT_INIT]:2,[Ue.EVENT_LOW_TRUST]:2,[Ue.LOG_UNID_INIT]:2};function Ye(e){i.debug("metricsNewRelic.sendNewRelicLog"),Me||Be(),e={...xe,unid:g("UNID"),timestamp:Date.now(),...e};const{context:t,source:n,experience:r,conversationId:o,...s}=(e.hasOwnProperty("reporting")?e.reporting:(0,u.U2)(We(),"optionalConfigs.reporting"))||{};t&&(e.context=t),n&&(e.source=n),e.conversation_id=o||(0,u.Vj)(),r&&(e.experience=r),e.reporting=function(e){const t=[];return Object.keys(e).forEach((n=>{t.push(`${n}(${e[n]})`)})),t.join(",")}(s),e.reporting||delete e.reporting,window.ONEID_WEB_SDK_MIGRATION&&(e[Ue.INFO]=e[Ue.INFO]?`${e[Ue.INFO]},isV4Migration(true)`:"isV4Migration(true)");const a=("string"===typeof e.action_name?e.action_name:"").toLowerCase(),c=He[a];if(je&&"number"===typeof c&&Math.random()>c/100)return void i.debug("not sending log - coin toss was tails.");const l=Le();var d;!e.trace&&l.length&&(e.trace=l),d=e,Object.keys(d).forEach((e=>{Ge[e]&&(d[e]||!1===d[e])||(i.debug(`analyticsUtils.removeInvalidNewRelicField: Removing key/value pair ${e}/${d[e]}`),delete d[e])}));const f=K();e.swid=f,e.anon=/{.+}/.test(f)?"false":"true";const p=be().then((t=>{const n=(0,u.U2)(t,"id_token");n&&(e.id_token=(0,u.Cd)(n,Ue.ID_TOKEN_MASK_LENGTH));return new P({sendLog:e=>({method:"GET",url:`${Fe}log`,body:{},headers:{},query:e})}).sendLog(e)}));if(window.newRelicRequests){const e=new Promise((e=>{p.finally(e)})).then((()=>{window.newRelicRequests=window.newRelicRequests.filter((t=>t!==e)),i.debug(`Removed resolved promise from 'newRelicRequests', ${window.newRelicRequests.length} remain`)}));window.newRelicRequests=[...window.newRelicRequests,e],i.debug(`Added promise to 'newRelicRequests', ${window.newRelicRequests.length} are now currently outstanding`)}return p}function ze(e){let t=0;for(const n in e){if(!/^[a-zA-Z0-9_]{1,30}$/.test(n))return!1;if(e[n].length>100)return!1;if(++t>10)return!1}return!0}function Qe(e){return!(!e||"string"!==typeof e)&&!!/^[A-Z0-9\.\-\_]+\.EXP$/g.test(e)}function Xe(e,t){Ye({[Ue.ACTION_NAME]:Ue[Ue.BU_EVENT_TO_ACTION_NAME[e]]||e,[Ue.INFO]:`payloadIncluded(${!!t})`}),O(e,t)}function Ze(){return pe.then((e=>e.call("inner","config.getSiteConfig"))).then(u._A)}const Je={getGuest:"getGuest",guestLogin:"guestLogin",guestMarketingOptIn:"guestMarketingOptIn",guestRecoveryMethods:"guestRecoveryMethods",guestRegister:"guestRegister",guestUpdateBySWID:"guestUpdateBySWID",loginWithRecoveryToken:"loginWithRecoveryToken",requestOTPCodePhoneVerification:"requestOTPCodePhoneVerification",notificationOTPRecovery:"notificationOTPRecovery",notificationOTPUpdateCredentials:"notificationOTPUpdateCredentials",otpRedeem:"otpRedeem",otpRedeemEmailVerification:"otpRedeemEmailVerification",otpRedeemUpdateCredentials:"otpRedeemUpdateCredentials",otpChangePassword:"otpChangePassword",otpUpgradeNRT:"otpUpgradeNRT",parentNotification:"parentNotification",validateDateOfBirth:"validateDateOfBirth",validateEmail:"validateEmail",validatePassword:"validatePassword",validateDisplayName:"validateDisplayName",activateSessionTransfer:"activateSessionTransfer"};const et="ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED",tt="AUTHORIZATION_ACCOUNT_LOCKED_OUT",nt="AUTHORIZATION_CREDENTIALS",rt="DISALLOWED_VALUE",ot="GUEST_GATED_AGEBAND",it="GUEST_GATED_BOTH_EMAIL_VERIFICATION",st="GUEST_GATED_EMAIL_VERIFICATION",at="GUEST_GATED_LOCATION",ct="GUEST_GATED_PARENT_EMAIL_VERIFICATION",ut="INVALID_VALUE",lt="PPU_MARKETING",dt="PROFILE_DISABLED",ft="PROFILE_USER_BANNED",pt="SYSTEM_UNAVAILABLE",ht="UNKNOWN_ERROR",gt={isPPU:[lt,"PPU_LEGAL"],isMarketingPPU:[lt],isGating:[ot,"GUEST_GATED_UNKNOWN","GUEST_GATED_EMBARGOED","GUEST_GATED_EMAIL",at,it,st,ct,tt,et,dt,"ACCOUNT_IS_CHILDED",ft],isGeoGated:[at],isVerifyEmailGated:[it,st,ct],isAgebandGated:[ot],isBanned:[ft],isDisabled:[dt,et],isSecurityFlagged:["AUTHORIZATION_ACCOUNT_SECURITY_LOCKED_OUT"],isPil2:["AUTHORIZATION_PARENTAL_CONSENT_REQUIRED"],isAccountMappingError:["ACCOUNT_MAPPING_NOT_FOUND_BUT_EMAIL_FOUND","NRT_ACCOUNT",rt,"UNKNOWN_ACCOUNT_STATUS"],isActionableInputError:["MISSING_VALUE",ut,"INUSE_VALUE",rt],isAccountMappingNotFoundError:["ACCOUNT_MAPPING_NOT_FOUND","ACCOUNT_MAPPING_NOT_FOUND_AND_EMAIL_NOT_FOUND"],isAuthorizationError:[nt,"AUTHORIZATION_BAD_EXTERNAL_TOKEN","AUTHORIZATION_EXTERNAL_ID_MISMATCH"],isMarketingLongform:["MARKETING_LONG_FORM_ENABLED"],isEtagMismatch:["VALID_ETAG_REQUIRED"],isServiceError:["SERVICE_ERROR",ht,pt],isLockedOut:[tt],isMase:["AUTHORIZATION_MASE_ERROR"],isOtpAuthError:["PHONE_NOT_FOUND","PHONE_NOT_VERIFIED","PHONE_VERIFICATION_NOT_ALLOWED"],isOtpCodeLockedOut:["DEVICE_LINK_LOCKOUT_REACHED"],isOtpRequired:["AUTHORIZATION_INVALID_NETWORK"],isInvalidLoginValue:["LOGIN_VALUE_INVALID","PROFILE_NOT_FOUND"],isInvalidOtpCode:["DEVICE_LINK_INVALID_OTP_CODE"],isInvalidAccessToken:["AUTHORIZATION_INVALID_OR_EXPIRED_TOKEN"],isInvalidRefreshToken:["AUTHORIZATION_INVALID_REFRESH_TOKEN"],isInvalidSessionTransferKeyError:["INVALID_SESSION_TRANSFER_KEY"],isRateLimited:["RATE_LIMITED","RATE_LIMITED_API"]},Et="ACTIONABLE_INPUT",mt="ADVISORY",_t="FAILURE_BY_DESIGN",yt="PPU_ACTIONABLE_INPUT",It="CHILD",wt="reduced",Rt="MACHINE_GENERATED";function Tt(e){if(!e)return null;const t=Ot(e),n=(0,u.U2)(e,"error.keyCategory");let r={};switch(Object.keys(gt).forEach((e=>{At(t,gt[e])&&(r[e]=!0)})),n){case yt:r.isPPU=!0;break;case mt:r.isAdvisoryError=!0;break;case Et:r.isActionableInputError=!0;const e=t.reduce(((e,t)=>{if(!t||!t.inputName)return e;const n=`${t.inputName}`,r=n.startsWith("profile.addresses"),o=(0,u.U2)(t,"data.type");if(r&&o){const r=`addresses.${o}.${n.replace(/.*\./,"")}`;return Object.assign(e,{[r]:t.code})}if(!r){const r=n.replace(/.*\./,"");return Object.assign(e,{[r]:t.code})}return e}),{});r.clientErrors=Object.keys(e).length?e:null,r.clientErrorsRawInputNames=t.filter((e=>e.inputName)).map((e=>e.inputName))}let o=(0,u.U2)(At(t,nt),"data")||{};r.isAuthorizationError&&o.passwordOrigin===Rt&&(r.isLoginSetPassword=!0);const i=e.isValid&&!e.isValid(),s=500===e.status;return(i||s||n===pt)&&(r.isServiceError=!0),t.forEach((e=>{e.code===ut&&"profile.region"===e.inputName&&(r.isInvalidRegionError=!0)})),0===Object.keys(r).length&&(r=null),r&&!r.clientErrors&&(r.clientErrors=null,r.clientErrorsRawInputNames=null),r}function Ot(e){const t=(0,u.U2)(e,"error.errors"),n=(0,u.U2)(e,"error.keyCategory");return!t||!n||!(0,u.U2)(t,"length")?[]:t.filter((function(e){return e.category===n}))}function At(e,t){return function(e,t,n=null){if(!Array.isArray(e))return[];Array.isArray(t)||(t=[t]);n&&!Array.isArray(n)&&(n=[n]);return(e||[]).filter((e=>-1!==t.indexOf(e.code)&&(!n||-1!==n.indexOf(e.inputName))))}(e,t)[0]}const vt={};function Nt(e,t){vt[e]=t}function kt(e){return vt[e]}function Ct(e){delete vt[e]}function bt(){for(let e in vt)delete vt[e]}function St(e){if(e)return Pt().then((t=>{const{s2CookieName:n,s2Domain:r}=t,o=_.getCookieDomain();let i=new Date(Date.now());i.setFullYear(i.getFullYear()+Oe),m(n,e,r,"/",i),g(n)!==e&&o&&m(n,e,o,"/",i)}))}function Pt(){return Ze().then((e=>{const{clientInfo:t={}}=e,n=t["s2-domain"]||window.location.hostname,r=t["s2-namespace"];return{s2CookieName:r?`${r}_${V}`:V,s2Domain:n,s2Namespace:r}}))}let Lt={language:null,featureFlags:["no-password-reuse"],endpoint:null,clientId:null};const Dt=new P({getGuest:function({accessToken:e,swid:t}){const n={method:"",url:"",body:{},headers:{},query:{}},r=`/guest/${t}`;return n.query.feature="always-get-entitlements",n.query.expand=["profile","displayname","linkedaccounts","marketing","entitlements","s2"],n.headers.authorization=`BEARER ${e}`,{...n,method:"GET",url:r,eventName:Ue.SERVICE_REFRESH_GUEST,storeResponseKey:Je.getGuest}},guestFlow:function(e,t=Ue.SERVICE_GUEST_FLOW){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest-flow",body:{email:e},eventName:t}},guestLogin:function({deviceId:e,eventName:t=Ue.SERVICE_LOGIN,loginValue:n,password:r,recaptchaToken:o}){const i={method:"",url:"",body:{},headers:{},query:{}};e&&(i.headers["device-id"]=e);o&&(i.headers["g-recaptcha-token"]=o);return{...i,method:"POST",url:"/guest/login",body:{loginValue:n,password:r},eventName:t,storeResponseKey:Je.guestLogin}},guestMarketingOptIn:function(e={}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/marketing",body:e,eventName:Ue.SERVICE_UPDATE_MARKETING,storeResponseKey:Je.guestMarketingOptIn}},guestRecoveryMethods:function({loginValue:e}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/recovery-methods",body:{loginValue:e},eventName:Ue.SERVICE_OTP_LOGIN_RECOVERY_METHODS,storeResponseKey:Je.guestRecoveryMethods}},guestRegister:function(e={}){const{password:t,profile:{username:n}={}}=e,r={autogeneratePassword:!t,autogenerateUsername:!n},o={method:"",url:"",body:{},headers:{},query:{}};e.recaptchaToken&&(o.headers["g-recaptcha-token"]=e.recaptchaToken);return{...o,method:"POST",url:"/guest/register",body:e,query:r,eventName:Ue.SERVICE_CREATE,storeResponseKey:Je.guestRegister}},guestUpdateBySWID:function({guest:e,swid:t,accessToken:n,eventName:r}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},query:{feature:"no-password-reuse"},method:"POST",url:`/guest/${t}`,body:(0,u.d9)(e),eventName:r,storeResponseKey:Je.guestUpdateBySWID}},guestValidate:function({body:e,eventName:t,storeResponseKey:n}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/validate",body:e,eventName:t,storeResponseKey:n}},licensePlatePeek:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"GET",url:`/license-plate/code/${e}`,eventName:Ue.SERVICE_LICENSE_PLATE_PEEK}},licensePlateRedeem:function(e,t){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/license-plate/code/${e}/activate`,body:{refreshToken:t},eventName:Ue.SERVICE_LICENSE_PLATE_REDEEM}},loginWithRecoveryToken:function({swid:e,recoveryToken:t,deviceId:n}){const r={method:"",url:"",body:{},headers:{},query:{}};n&&(r.headers["device-id"]=n);return{...r,method:"POST",url:"/guest/login/recoveryToken",body:{swid:e,recoveryToken:t},eventName:Ue.SERVICE_LOGIN_RECOVERY,storeResponseKey:Je.loginWithRecoveryToken}},logout:function({swid:e,tokenAndClientIds:t=[]}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/guest/${e}/logout`,body:{tokenAndClientIds:t},eventName:Ue.SERVICE_LOGOUT}},notificationOTPEmailVerification:function({accessToken:e,eventName:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/email-verification",headers:{authorization:`BEARER ${e}`},eventName:t}},notificationOTPRecovery:function({recoveryPayload:e,eventName:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/recovery",body:e,eventName:t,storeResponseKey:Je.notificationOTPRecovery}},notificationOTPUpdateCredentials:function({accessToken:e,eventName:t}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/notification/otp/update-credentials",eventName:t,storeResponseKey:Je.notificationOTPUpdateCredentials}},otpRedeem:function({otpCode:e,sessionIds:t,eventName:n,assessmentId:r}){const o={passcode:e,sessionIds:t};r&&(o.assessmentId=r);return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/otp/redeem",body:o,eventName:n,storeResponseKey:Je.otpRedeem}},otpRedeemEmailVerification:function({accessToken:e,otpCode:t,sessionIds:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/verify-email",body:{passcode:t,sessionIds:n},eventName:Ue.SERVICE_OTP_EMAIL_VERIFICATION_REDEEM,storeResponseKey:Je.otpRedeemEmailVerification}},otpRedeemUpdateCredentials:function({accessToken:e,otpCode:t,sessionIds:n,eventName:r}){const o={passcode:t,sessionIds:n};return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/redeem-update-credentials",body:o,eventName:r,storeResponseKey:Je.otpRedeemUpdateCredentials}},otpChangeEmail:function({recoveryToken:e,swid:t,newEmail:n}){const r=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:r,headers:{authorization:`BEARER ${e}`},body:{email:n},eventName:Ue.SERVICE_UPDATE_GUEST_CREDENTIALS}},otpChangePassword:function({recaptchaToken:e,recoveryToken:t,swid:n,newPassword:r,loginValue:o}){const i=`/clickback-token/change-password/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:i,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{newPassword:r,loginValue:o},eventName:Ue.SERVICE_OTP_LOGIN_RESET_PASSWORD,storeResponseKey:Je.otpChangePassword}},updateCredentialsBySWID:function({recoveryToken:e,swid:t,newPassword:n,eventName:r}){const o=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:o,headers:{authorization:`BEARER ${e}`},body:{password:n},eventName:r}},otpUpgradeNRT:function({recaptchaToken:e,recoveryToken:t,swid:n,password:r,username:o}){const i=`/clickback-token/upgrade-nrt/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"PUT",url:i,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{password:r,username:o},eventName:Ue.SERVICE_OTP_LOGIN_UPGRADE_NRT,storeResponseKey:Je.otpUpgradeNRT}},refreshAuthorization:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/refresh-auth",body:{refreshToken:e},eventName:Ue.SERVICE_REFRESH_TOKEN}},redeemOTPCodePhoneVerification:function({otpCode:e,sessionIds:t,swid:n,accessToken:r,eventName:o}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${r}`},method:"POST",url:`/guest/${n}/verify/otp`,body:{passcode:e,sessionIds:t},eventName:o,storeResponseKey:Je.redeemOTPCodePhoneVerification}},requestOTPCodePhoneVerification:function({phoneGuid:e,accessToken:t,eventName:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${t}`},method:"POST",url:"/notification/otp/verification",body:{phoneGuid:e},eventName:n,storeResponseKey:Je.requestOTPCodePhoneVerification}},sendParentNotification:function({swid:e,accessToken:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/notification/parental-approval/${e}`,headers:{authorization:`BEARER ${t}`},eventName:Ue.EVENT_REGISTRATION_PIL2_NOTIFY,storeResponseKey:Je.parentNotification}},deleteAccount:function({guest:e,swid:t,accessToken:n,eventName:r}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},method:"DELETE",url:`/guest/${t}`,body:{},eventName:r,storeResponseKey:Je.deleteAccount}},activateSessionTransfer:function({accessToken:e,refreshToken:t,sessionTransferKey:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`,"Content-Type":"application/json"},method:"POST",url:"/session/transfer/activate",body:{refreshToken:t,sessionTransferKey:n},storeResponseKey:Je.activateSessionTransfer}}}),Ut=Dt;let Gt;Ut.addRequestMutator((e=>{e.request.headers={...e.request.headers,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache",Expires:"-1"};const t=(0,u.U2)(U(),"debug.geoIP");t&&(e.request.headers["x-forwarded-for"]=t)})),Ut.addRequestMutator((e=>{e.request.query.langPref=Lt.language})),Ut.addRequestMutator((e=>{e.request.query.feature=Lt.featureFlags})),Ut.addRequestMutator((e=>{e.request.url=`${Lt.endpoint}/client/${Lt.clientId}${e.request.url}`})),Ut.addRequestMutator((e=>{Gt=(0,u.Vj)();const t=kt("workflowOptions"),n=(0,u.U2)(t,"options.optionalConfigs.reporting.conversationId")||(0,u.Vj)();e.request.headers={...e.request.headers,"conversation-id":n,"correlation-id":Gt}})),Ut.addRequestMutator((e=>{if(!e.request.headers.authorization)return new Promise((t=>{pe.then((n=>{n.call("responder","get.cookie",`${Lt.clientId}.${x}`).then((n=>{n&&(e.request.headers.authorization=`APIKEY ${n}`),t()})).catch((()=>t()))}))}))})),Ut.addRequestMutator((e=>{const t=kt("workflowOptions");if(t){const n=(0,u.U2)(t,"options.optionalConfigs.reporting");e.request.headers={...e.request.headers,"oneid-reporting":(0,u.uP)(n)}}})),Ut.addRequestMutator((e=>{e.newRelicLog=Ke(e.request.eventName||"missing_action_name")})),Ut.addResponseMutator((e=>{const{errorCodes:t,keyCategory:n,statusCode:r}=function(e){const t=(0,u.U2)(e,"error.keyCategory")||"";return{errorCodes:((0,u.U2)(e,"error.errors")||[]).map((e=>{let t=e.code;e.inputName&&(t+=`:${e.inputName}`);const n=(0,u.U2)(e,"data.disclosures");return n&&n.forEach((e=>{t+=`:${e.disclosureCode}`})),t}))||[],keyCategory:t,statusCode:(0,u.U2)(e,"status")||null}}(e.response),o=kt("logoutType"),s={[Ue.ERROR_CATEGORY]:n,[Ue.ERROR_CODES]:t.join(","),[Ue.TRANSACTION_ID]:Gt};o&&(s[Ue.INFO]=`logoutType(${o})`,Ct("logoutType")),!r||r>=400&&r<500||r>=200&&r<300||(s[Ue.PROBLEM]=!0),i.debug("sending log : ",JSON.stringify(s,null,2)),e.newRelicLog.send(s),e.request.storeResponseKey&&Nt(e.request.storeResponseKey,e.response)})),Ut.addResponseMutator((e=>{const t=e.response&&e.response.headers["api-key"];if(t){let e=new Date;e.setDate(e.getDate()+1),pe.then((n=>n.message("responder","set.cookie",{key:`${Lt.clientId}.${x}`,value:t,expires:e})))}})),Ut.addResponseMutator((e=>{const t=(0,u.U2)(e.response,"data.s2");t&&St(t)})),Ut.addResponseMutator((e=>{!function(e){e.response.parsedErrors=Tt(e.response),(0,u.U2)(e.response.parsedErrors,"isPPU")&&Nt("ppuErrors",(0,u.U2)(e.response,"error.errors"))}(e)}));const xt="Already initialized",Ft="Configuration options have already been set",Mt="Could not initialize cross frame communication",Vt="`DisneyID` global object is soon to be deprecated. Use `OneID` instead.",$t="OneID app timed out",jt="Invalid argument",Bt="INVALID_PAIRING_CODE",qt="MISSING_PAIRING_CODE",Wt="clientId not provided",Kt="No configuration options provided",Ht="NO_DATA",Yt="responderPage not provided",zt="Could not get site config",Qt="The campaignId provided is not valid",Xt="Not initialized",Zt="PROFILE_UPDATE_INVALID",Jt="Session already established",en="Session not established",tn="FAILURE_BY_DESIGN",nn="UNKNOWN_ERROR";function rn(e){return new Promise(((t,n)=>{Dt.licensePlatePeek(e).then((e=>{if((0,u.U2)(e,"parsedErrors.isActionableInputError"))return n({errorCodes:Bt});t(e)})).catch((()=>n({errorCodes:nn})))}))}function on(){const{clientId:e,langPref:t,cssOverride:n,debug:r={}}=U(),{country:o,geoIP:i,iOSAutomation:s,testProfileFlag:a}=r,c=window.ONEID_WEB_SDK_MIGRATION?"bundleMigration":"bundle",u=g(h)||"INFO",l=s?"&iOSAutomation=true":"",d=a?"&testProfileFlag=Y":"",f=i?`&geoIP=${i}`:"",p=o?`&countryCode=${o}`:"";return`${Ie.replace("https://ui-qa.registerdisney","https://uiv4-qa.registerdisney")}/${c}/web/${e}/${t}?cssOverride=${n}${p}&logLevel=${u}${l}${d}${f}`}function sn(){const{clientId:e,responderPage:t}=U(),n=we(),r=new URL(t);return r.searchParams.append("clientId",e),r.searchParams.append("environment",n),r.href}const an=function(){const e=document.querySelector("html"),t=document.createElement("style");let n;return{showLightbox:function(){e&&e.classList.add("oneid-lightbox-open"),n.style.display="block",n.classList.add("state-active"),n.querySelector("#oneid-iframe").focus()},hideLightbox:function(){e&&e.classList.remove("oneid-lightbox-open"),n.style.display="none",n.classList.remove("state-active")},createInner:function(){const e=/(ipad|iphone|ipod)/gi.test(navigator.userAgent);t.setAttribute("id","oneid-style"),t.setAttribute("type","text/css"),t.innerHTML=`\n    div#oneid-wrapper {\n      position: ${e?"absolute":"fixed"};\n      display: none;\n      opacity: 0;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    div#oneid-wrapper.state-active {\n      z-index: 9999999;\n      opacity: 1;\n      transition: opacity 300ms;\n      -webkit-transition: opacity 300ms;\n    }\n    iframe#oneid-iframe {\n      width: 100%;\n      height: 100%;\n    }\n\n    html.oneid-lightbox-open {\n      overflow: hidden;\n      ${e?"height: 100%;":""}       \n    }\n\n    html.oneid-lightbox-open body {\n      overflow: hidden;\n      ${e?"height: 100%;":""}\n    }\n    `;const o=r({name:"oneid-iframe",title:"Account Dialog",documentURL:on()});return n=document.createElement("div"),n.setAttribute("id","oneid-wrapper"),n.appendChild(o),cn().then((()=>{document.head.appendChild(t),document.body.appendChild(n)})),o},createResponder:function(){const e=r({name:"oneid-secure-responder",documentURL:sn()});return e.style.display="none",cn().then((()=>{document.body.appendChild(e)})),e}};function r({name:e,title:t="",documentURL:n}){const r=document.createElement("iframe");return r.setAttribute("id",e),r.setAttribute("name",e),r.setAttribute("frameborder","0"),r.setAttribute("title",t),r.setAttribute("src",n),r}}();function cn(){return new Promise((e=>{const{readyState:t}=document;if("complete"===t||"loaded"===t||"interactive"===t)return e();document.addEventListener("DOMContentLoaded",(()=>e()),{once:!0})}))}function un(){return Ze().then((e=>e?Promise.resolve():Promise.reject({errorCodes:zt})))}function ln(e=3e4,t=$t){let n;return Object.assign(new Promise(((r,o)=>{n=setTimeout((()=>o({errorCodes:t})),e)})),{cancel:()=>(clearTimeout(n),this)})}function dn(e,t={}){const n=(0,u.U2)(e,"optionalConfigs.displayOptions.cssContext"),r=(0,u.U2)(e,"optionalConfigs.displayOptions.darkMode");if(void 0!==n)if((0,u.kH)(n))t.displayOptions={...t.displayOptions,cssContext:n};else{Ke(Ue.LOG_INVALID_DISPLAY_OPTION).send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:"cssContext",[Ue.INFO]:`cssContext(${n})`})}if(void 0!==r)if("boolean"===typeof r)t.displayOptions={...t.displayOptions,darkMode:r};else{Ke(Ue.LOG_INVALID_DISPLAY_OPTION).send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:"darkMode",[Ue.INFO]:`darkMode(${r})`})}return t.options=We(),t.allowSkip=!!(0,u.U2)(e,"allowSkip"),t}var fn=n(0),pn=n.n(fn);const hn={ADULT:"X",TEEN:"Y",CHILD:"Z"};function gn(e){if(!e)return Promise.resolve();const{clientId:t}=U(),n=we();return pe.then((r=>r.call("responder","set.cookie",{key:`${t}-${n}.${F}`,value:e,expires:0,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-lib-cookies-identity)",[Ue.STACK_TRACE]:t})}))))}const En="00";function mn(){const{clientId:e}=U(),t=we();try{localStorage.removeItem(`${e}-${t}.guest`)}catch(e){}}function _n(){return kt("tokenData")?yn():be().then((e=>{if(e&&!e.isExpired)return Nt("tokenData",e),yn()}))}function yn(){const{clientId:e}=U(),t=we();return function(){const{clientId:e}=U(),t=we();return pe.then((n=>n.call("responder","get.cookie",`${e}-${t}.${F}`).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-lib-cookies-identity)",[Ue.STACK_TRACE]:t})}))))}().then((n=>{const r=kt("tokenData"),o=(0,u.U2)(r,"access_token");if(!o||!n)return;const i=function(e,t,n,r){let o=null;try{o=localStorage.getItem(`${n}-${r}.guest`)}catch(e){}return function(e,t,n){let r=null;try{r=JSON.parse(pn().decrypt(e.substring(En.length)+t,n))}catch(e){}return r}(""+e,t,o)}(n,o,e,t);if(!i)return function(){const{clientId:e}=U(),t=we(),n=kt("tokenData"),r=(0,u.U2)(n,"access_token"),o=(0,u.U2)(n,"swid");return Dt.getGuest({accessToken:r,swid:o}).then((o=>{if(200!==o.status)return null;const i=(0,u.U2)(o.data,"token")||n,s={...o.data,token:i};Nt("getGuestResponse",o),Nt("guest",s);return gn(wn({guest:s,token:i},r,e,t)),s}))}();return(0,u.t8)(i,"guest.token",r)}))}function In(e,t){return new Promise((n=>{if(!(0,u.U2)(e,"guest"))return;let r;r=t?function(e){if(!e)return Promise.resolve();const{clientId:t}=U(),n=we();let r=new Date(Date.now());r.setFullYear(r.getFullYear()+Oe);const o=ae({token:e});return pe.then((e=>e.call("responder","set.cookie",{key:`${t}-${n}.${B}`,value:o,expires:r,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`)}))))}(e.token):Promise.resolve();const{clientId:o}=U(),s=we();let a;a=(0,u.U2)(e,"token.access_token")?Promise.resolve(e):be();const c=function(e){const t=hn[(0,u.U2)(e,"profile.ageBand")||""],n=(0,u.U2)(e,"profile.region")||(0,u.U2)(e,"profile.countryCodeDetected"),r=t+n,{clientId:o}=U(),s=we();if(!t||!n||!e)return Promise.resolve();let a=new Date(Date.now());return a.setFullYear(a.getFullYear()+Oe),pe.then((e=>e.call("responder","set.cookie",{key:`${o}-${s}-${G}`,value:r,expires:a}).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-lib-cookies-ageBandCountry)",[Ue.STACK_TRACE]:t})}))))}((0,u.U2)(e,"guest"));Promise.all([a,r,c]).then((t=>{gn(wn(e,(0,u.U2)(t[0],"token.access_token"),o,s)).then(n),Nt("wasLoggedIn",!0)}))}))}function wn(e,t,n,r){const o=function(e,t){let n=(0,u.d9)(e),r=JSON.stringify(n),o=(0,u.kn)(JSON.stringify({guest:e.guest})).toString(16);return{data:pn().encrypt(o+t,r),checksum:En+o}}({guest:e.guest,created:(new Date).toISOString()},t);try{localStorage.setItem(`${n}-${r}.guest`,o.data)}catch(e){}return o.checksum}function Rn(e,t={}){const{clientId:n}=U(),r=we(),o=t.refresh_token,i=[];return o&&i.push({clientId:`${n}-${r}`,token:o}),e&&i.length?Dt.logout({swid:e,tokenAndClientIds:i}):Promise.resolve()}const Tn="error",On="init",An="login",vn="logout",Nn="low-trust",kn="refresh";function Cn(e){const{clientId:t}=U(),n=we();return _n().then((r=>(mn(),Rn((0,u.U2)(r,"profile.swid"),(0,u.U2)(r,"token")).then((()=>pe.then((r=>(r.message("inner","guest.logout"),W((0,u.Vj)()),r.call("responder","guest.logout",`${t}-${n}`).finally((()=>(Xe(vn),e("done"))))))))))))}const bn=[{readToken:{stepExecution:function(e){return be().then((t=>t?(Nt("tokenData",t),(0,u.U2)(t,"refresh_token")?e("readGuestFromLocalStorage"):(Nt("logoutType","norefresh"),void e("ensureLoggedOut"))):e())).catch((()=>e()))},results:{readGuestFromLocalStorage:"readGuestFromLocalStorage"}}},{readGuestFromLocalStorage:{stepExecution:function(e){const t=kt("workflowOptions"),n=(0,u.U2)(t,"forceRefresh"),r=(0,u.U2)(t,"fullPayloadRequested");yn().then((t=>{if(!t)return e("getGuestFromGuestController");t&&Nt("guest",t);const o=(0,u.U2)(t,"token.created"),i=!!o&&new Date(o).getTime()+Re<Date.now(),s=(0,u.U2)(t,"payload")===wt;if(i||n||s&&r)return e("getGuestFromGuestController");e()}))},results:{getGuestFromGuestController:"getGuestFromGuestController"}}},{getGuestFromGuestController:{stepExecution:function(e){const t=kt("tokenData"),n=kt("guest")||{token:t},r=(0,u.U2)(n,"token.access_token"),o=(0,u.U2)(n,"token.swid")||(0,u.U2)(n,"profile.swid");return r&&o?Dt.getGuest({accessToken:r,swid:o}).then((t=>{Nt("getGuestResponse",t);const r=(0,u.U2)(t.data,"token")||n.token;if(200===t.status)return Nt("guest",{...t.data,token:r}),e("saveSession");const o=(0,u.U2)(t,"parsedErrors")||{};return o.isSecurityFlagged||o.isDisabled||o.isInvalidAccessToken?(Nt("logoutType","getGuest"),e("forceLogout")):e()})):e("forceLogout")},results:{forceLogout:"forceLogout",saveSession:"saveSession"}}},{forceLogout:{stepExecution:Cn,results:{}}},{saveSession:{stepExecution:function(e){const t=kt("guest")||{};return t&&t.token?In({guest:t,token:t.token}).then(e):e()},results:{}}}];function Sn(){const{clientId:e}=U(),t=`${e}-${we()}`;return`${M}${(0,u.kn)(t).toString(16)}`}function Pn(){return g(Sn())}function Ln(){return new Promise((e=>{if(Pn())return i.debug("Mutex#cookie already present"),e(!1);setTimeout((()=>{if(Pn())return i.debug("Mutex#cookie already present"),e(!1);i.debug("Mutex#setting cookie");const t=new Date(Date.now()+Ne);return m(Sn(),"0",_.getCookieDomain(),"/",t),e(!0)}),Math.floor(1e3*Math.random()+1e3))}))}let Dn=!1;function Un(){return Dn}function Gn(e){Dn=!!e}const xn=[{readToken:{stepExecution:function(e){return be().then((n=>{if(!n)return e();Nt("tokenData",n);return kt("originalRefreshToken")!==n.refresh_token?(t(),Nt("originalRefreshToken",n.refresh_token),e("emitRefreshEvent")):(0,u.U2)(n,"refresh_token")?e("acquireMutex"):(Nt("logoutType","norefresh"),t(),void e("ensureLoggedOut"))})).catch((()=>e()));function t(){Nt("mutexAttempt",0)}},results:{ensureLoggedOut:"ensureLoggedOut",acquireMutex:"acquireMutex",emitRefreshEvent:"emitRefreshEvent"}}},{ensureLoggedOut:{stepExecution:Cn,results:{done:"releaseMutex"}}},{acquireMutex:{stepExecution:function(e){let t=kt("mutexAttempt")||0;return t++,Nt("mutexAttempt",t),t>Ae?(i.debug("acquireMutex#max attempts reached"),n(),e("ensureGuestLoggedOut")):Ln().then((t=>{if(!t)return i.debug("acquireMutex#could not acquire"),setTimeout((()=>{e("readToken")}),ve);n(),e("refreshToken")}));function n(){Nt("mutexAttempt",0)}},results:{readToken:"readToken",ensureGuestLoggedOut:"ensureLoggedOut",refreshToken:"refreshToken"}}},{refreshToken:{stepExecution:function(e){const t=kt("tokenData")||{},n=Un();return Dt.refreshAuthorization(t.refresh_token).then((t=>{Nt("tokenRefreshResponse",t);const r=(0,u.U2)(t,"data.token")||{},o=(0,u.U2)(t,"parsedErrors")||{},i=200===t.status&&r.access_token&&r.refresh_token,s=n&&r.access_token&&r.refresh_token;return i||s?yn().then((t=>{let n=new Date(Date.now());return t.token=r,t.token.created=n.toISOString(),t.token.lastChecked=t.token.created,t.token.expires=y(n,t.token.ttl).toISOString(),t.token.refresh_expires=y(n,t.token.refresh_ttl||0).toISOString(),Nt("tokenData",t.token),Nt("originalRefreshToken",t.token.refresh_token),In({guest:t,token:t.token},!0).then((()=>e("emitRefreshEvent")))})):o.isInvalidRefreshToken?(Nt("logoutType","norefresh"),e("ensureGuestLoggedOut")):o.isSecurityFlagged?(Nt("logoutType","securityFlagged"),e("ensureGuestLoggedOut")):o.isGating?n?e("ensureGuestLoggedOut"):pe.then((t=>t.call("inner","runWorkflow",{name:"GATING",workflowData:{parsedErrors:o}}).then((()=>(an.showLightbox(),e("ensureGuestLoggedOut")))))):o.isPPU?n?e("ensureGuestLoggedOut"):Promise.all([_n(),pe]).then((([n,r])=>r.call("inner","runWorkflow",{guest:n,name:"LOGIN",step:"ppuSubflow",workflowData:{parsedErrors:o,ppu:{errors:t.error.errors}}}).then((()=>{an.showLightbox(),e()})))):void 0})).catch((()=>e("releaseMutex")))},results:{ensureGuestLoggedOut:"ensureLoggedOut",releaseMutex:"releaseMutex",emitRefreshEvent:"emitRefreshEvent"}}},{forceRefresh:{stepExecution:function(e){return be().then((t=>{if(!t)return e();Nt("tokenData",t),e("refreshToken")}))},results:{refreshToken:"refreshToken"}}},{emitRefreshEvent:{stepExecution:function(e){const t=kt("tokenData");return Xe(kn,t),Nt("tokenRefreshed",!0),Promise.all([_n(),pe]).then((([t,n])=>{t&&n.message("inner","setGuest",t),e()})).catch(e)},results:{releaseMutex:"releaseMutex"}}},{releaseMutex:{stepExecution:function(e){E(Sn(),_.getCookieDomain(),"/"),Ct("tokenData"),e()},results:{}}}];function Fn(e){new De("tokenRefresh",xn,void 0,(()=>e("done"))).runWorkflow()}const Mn=[{anonymize:{stepExecution:function(e){K()||W((0,u.Vj)()),e("readSession")},results:{readSession:"readSession"}}},{readSession:{stepExecution:function(e){return be().then((t=>t?(Nt("tokenData",t),t.isExpired?(i.info("Starting token refresh"),e("tokenRefresh")):void e("getGuestSubflow")):e()))},results:{getGuestSubflow:"getGuestSubflow",tokenRefresh:"tokenRefreshSubflow"}}},{getGuestSubflow:{stepExecution:function(e){new De("getGuest",bn,"readGuestFromLocalStorage",(()=>{const t=kt("guest");if(t)return pe.then((e=>e.message("inner","setGuest",t))).finally(e);e()})).runWorkflow()},results:{}}},{tokenRefreshSubflow:{stepExecution:Fn,results:{}}}];const Vn=[{validate:{stepExecution:function(e){const t=kt("workflowOptions");let n=(0,u.U2)(t,"guestFlowEmail"),r=!1;if("string"===typeof n&&(n=n.trim().replace(/<|>/gim,""),r=d.test(n)),r)return Nt("guestFlowEmail",n),e("checkForAccount");Ct("guestFlowEmail"),e("launchRegistration")},results:{checkForAccount:"checkForAccount",launchRegistration:"launchRegistration"}}},{checkForAccount:{stepExecution:function(e){const t=kt("guestFlowEmail");return t?Dt.guestFlow(t).then((t=>{const n=(0,u.U2)(t,"data.guestFlow")||"",r=n.match(p)?"launchLogin":"launchRegistration";Nt("guestFlowCode",n),e(r)})).catch((()=>e("launchRegistration"))):e("launchRegistration")},results:{launchLogin:"launchLogin",launchRegistration:"launchRegistration"}}},{launchRegistration:{stepExecution:function(e){Nt("guestFlowName","REGISTRATION_FLOW");const t=kt("workflowOptions"),n=kt("guestFlowEmail")||"",r=kt("guestFlowCode"),o={profile:{email:n}};return pe.then((n=>n.call("inner","runWorkflow",{name:"REGISTRATION",workflowOptions:t,guestChanges:o,persistentTealiumData:{flow_name:"Guest Flow Registration",guest_flow:r}}).then((()=>{an.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");i.error(`Error in PatchBay call: ${n}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-workflows-guestFlow-launchRegistration)",[Ue.STACK_TRACE]:n}),e()}))))},results:{}}},{launchLogin:{stepExecution:function(e){Nt("guestFlowName","LOGIN_FLOW");const t=kt("workflowOptions"),n=kt("guestFlowCode");return pe.then((r=>r.call("inner","runWorkflow",{name:"LOGIN",workflowData:{loginValue:kt("guestFlowEmail")},workflowOptions:t,persistentTealiumData:{flow_name:"Guest Flow Login",guest_flow:n}}).then((()=>{an.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");i.error(`Error in PatchBay call: ${n}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-workflows-guestFlow-launchLogin)",[Ue.STACK_TRACE]:n}),e()}))))},results:{}}}];function $n(e){const t={data:{email:null,legal:[]},error_codes:null},n=kt("workflowOptions")||{};t.data.campaignId=n.promotionId,Nt("workflowOptions",{...n,fullPayloadRequested:!0});new De("getGuest",bn,null,(()=>{const n=kt("guest");return n?(t.data.email=n.profile.email,Nt("responsePayload",t),e("guestIsLoggedIn")):(Nt("responsePayload",t),e("guestIsNotLoggedIn"))})).runWorkflow()}const jn="AGE_GATED",Bn="ALREADY_OPT_IN",qn="INVALID_EMAIL",Wn="INVALID_LOCATION",Kn="NO_DATA",Hn="NO_VALID_CAMPAIGN",Yn="SERVICE_ERROR";function zn(e){let t=e.errors[0];if("MISSING_VALUE"===t.code){let e=t.inputName.toUpperCase();return t.code+"_"+e}return t.code}function Qn(e){let t=kt("responsePayload");Ze().then((n=>{let r=(0,u.U2)(n,"compliance.ageBands.ADULT.country");if("US"!==r)return t.data={},t.error_codes=Wn,Nt("responsePayload",t),e();Nt("defaultLegalCountry",r),e("getLegalData")}))}const Xn=(e,t=!1)=>({code:e.name,content:e.text,subscribed:t,preselected:e.checked});function Zn(e){Ze().then((t=>{const n=kt("guest"),r=(0,u.U2)(n,"profile.region"),o=(0,u.U2)(n,"profile.countryCodeDetected"),i=(0,u.U2)(t,"compliance.defaultCountryCode");Nt("guestLocation",r||o||i||"US"),e("checkProfile")}))}function Jn(e){let t=kt("responsePayload");const n=kt("guest"),r=kt("workflowOptions"),o=function(e,t){if("CHILD"===(0,u.U2)(e,"profile.ageBand"))return jn;if("US"!==kt("guestLocation"))return Wn;if(null!==t&&t!==(0,u.U2)(e,"profile.email"))return qn;return!1}(n,(0,u.U2)(r,"buData.email")||null)||!1;if(o)return t.error_codes=o,t.data={},Nt("responsePayload",t),e();e("hasOptedIntoAnything")}const er=[{runGetGuestWorkflow:{stepExecution:$n,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:Qn,results:{getLegalData:"getLegalData"}}},{getLegalData:{stepExecution:function(e){const t=kt("responsePayload");return Promise.all([Ze(),pe.then((e=>e.call("inner","config.getL10n"))).then(u._A)]).then((([n,r])=>{const o=(0,u.U2)(n,"legal.ADULT.disclosures"),i=[];o.forEach((e=>{i.push({code:e.disclosureCode,requiresActiveConsent:e.requiresActiveConsent,accepted:!e.requiresActiveConsent,content:r[`legal.${e.disclosureCode}_create`]})})),t.data.legal=i,Nt("responsePayload",t),e("getMarketingData")}))},results:{getMarketingData:"getMarketingData"}}},{getMarketingData:{stepExecution:function(e){const t=kt("responsePayload"),n=kt("workflowOptions").promotionId;return Ze().then((r=>{const o=(0,u.U2)(kt("guest"),"profile.ageBand")||"ADULT",i=(0,u.U2)(r,`newsletters.${o}.${n}`),s=new Set,a=[];i.forEach((e=>{s.has(e.name)||(s.add(e.name),a.push(Xn(e)))})),t.data.marketing=a,Nt("responsePayload",t),e()}))},results:{}}},{getGuestLegalCountry:{stepExecution:Zn,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:Jn,results:{hasOptedIntoAnything:"hasOptedIntoAnything"}}},{hasOptedIntoAnything:{stepExecution:function(e){const t=kt("guest");e((0,u.U2)(t,"marketing")?"filterOptedInMarketingLists":"getMarketingData")},results:{getMarketingData:"getMarketingData",filterOptedInMarketingLists:"filterOptedInMarketingLists"}}},{filterOptedInMarketingLists:{stepExecution:function(e){Ze().then((t=>{const n=kt("guest"),r=(0,u.U2)(n,"marketing"),o=(0,u.U2)(n,"profile.ageBand"),i=kt("workflowOptions").promotionId,s=(0,u.U2)(t,`newsletters.${o}.${i}`),a=[];for(const e of s)a.push(...e.lists);const c=new Set(r.filter((e=>e.subscribed)).map((e=>e.code))),l=a.filter((e=>!c.has(e.name))),d=kt("responsePayload");l.length?d.data.marketing=l.map((e=>Xn(e))):(d.error_codes=Bn,d.data={}),Nt("responsePayload",d),e()}))},results:{}}}];const tr=[{runGetGuestWorkflow:{stepExecution:$n,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:Qn,results:{getLegalData:"prepareRequest"}}},{getGuestLegalCountry:{stepExecution:Zn,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:Jn,results:{hasOptedIntoAnything:"prepareRequest"}}},{prepareRequest:{stepExecution:function(e){const t=(0,u.U2)(kt("workflowOptions"),"buData"),n=(0,u.U2)(t,"legal"),r=(0,u.U2)(t,"marketing");if(!n||!r)return e();Nt("marketingParams",r);let o=(0,u.U2)(t,"campaignId"),i=kt("guestLocation")||kt("defaultLegalCountry");Nt("requestPayload",{profile:{email:t.email,countryCodeDetected:i,region:i},legalAssertions:n.filter((e=>e.accepted)).map((e=>e.code)),campaign:o}),e("prepareMarketingPayload")},results:{prepareMarketingPayload:"prepareMarketingPayload"}}},{prepareMarketingPayload:{stepExecution:function(e){const t=kt("requestPayload"),n=t.campaign,r=kt("marketingParams");let o=kt("guest"),i=o&&o.marketing;i&&r.push(...o.marketing);const s=function(e){let t=e.filter((e=>e.subscribed)),n=new Set,r=[];return t.forEach((e=>{n.has(e.code)||(r.push(e),n.add(e.code))})),r}(r);Ze().then((r=>{let a=(0,u.U2)(r,`newsletters.ADULT.${n}`),c=!1,l=[];if(i){let e=[];a.forEach((t=>e.push(...t.lists)));let t={};e.forEach((e=>t[e.name]=e));for(const e of s){let n=t[e.code];if(!n){c=!0;break}l.push({code:n.name,subscribed:!0,textId:n.textId})}}else{let t={};a.forEach((e=>t[e.name]=e));for(const e of s){let n=t[e.code];if(!n){c=!0;break}{const e=n.lists.map((e=>({code:e.name,subscribed:!0,textId:n.textId})));l.push(...e)}}if(c)return Nt("responsePayload",{data:{},error_codes:"NO_VALID_CAMPAIGN"}),e()}t.marketing=l,Nt("requestPayload",t),e(o?"executeUpdate":"executeRequest")}))},results:{executeUpdate:"executeUpdate",executeRequest:"executeRequest"}}},{executeRequest:{stepExecution:function(e){const t=kt("requestPayload");return Dt.guestMarketingOptIn(t).then((t=>{let n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?Nt("responsePayload",{data:{},error_codes:zn(t.error)}):Nt("responsePayload",{data:"SUCCESS",error_codes:null}),e()})).catch((()=>{Nt("responsePayload",{data:{},error_codes:Yn}),e()}))},results:{}}},{executeUpdate:{stepExecution:function(e){const t=kt("requestPayload").marketing,n=kt("guest"),r=(0,u.U2)(n,"profile.swid"),o=(0,u.U2)(n,"token.access_token"),i=Ue.SERVICE_UPDATE_GUEST,s={marketing:t};return Dt.guestUpdateBySWID({guest:s,swid:r,accessToken:o,eventName:i}).then((t=>{let n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?(Nt("responsePayload",{data:{},error_codes:zn(t.error)}),e()):(Nt("responsePayload",{data:"SUCCESS",error_codes:null}),e("reloadGuest"))})).catch((()=>{Nt("responsePayload",{data:{},error_codes:Yn}),e()}))},results:{reloadGuest:"reloadGuest"}}},{reloadGuest:{stepExecution:function(e){let t=kt("workflowOptions")||{};t.fullPayloadRequested=!0,t.forceRefresh=!0,Nt("workflowOptions",t),new De("getGuest",bn,null,(()=>e())).runWorkflow()},results:{}}}],nr=["firstName","gender","lastName","middleName","prefix","suffix","languagePreference","pronunciationName","address.billing","address.home","address.school","address.shipping","address.work","phone.day","phone.mobile","phone.night","proposedDisplayName"],rr=["email","username","address.other","phone.fax","dateOfBirth","password","displayName","region"],or=["line1","line2","line3","city","stateProvince","postalCode","country","preferred"],ir=["number","internationalPrefix","countryCode","extension","preferred"];function sr(e,t){const n=Object.keys(e).filter((function(e){return 0===e.indexOf(t+".")})).map((function(t){const n=t.split(".");return{type:n[1].toUpperCase(),field:n[2],value:e[t]}})).reduce((function(e,t){return(0,u.t8)(e,[t.type,t.field].join("."),t.value),e}),{});return Object.keys(n).map((function(e){return Object.assign(n[e],{type:e})}),[])}function ar(e){e.forEach((e=>{Object.keys(e).forEach((function(t){null===e[t]&&delete e[t]}))}))}function cr(e,t,n){t.map((function(t){const r=(o=e,i=t.type,o.filter((e=>e.type===i)));var o,i;return r.length&&(t[n]=r[0][n]),t}))}function ur(e){let t=!1;for(const n in e)"addressGuid"!==n&&"type"!==n&&"preferred"!==n&&(t=!0);return t}function lr(e){if("string"===typeof e)return e.trim();if("object"===typeof e)for(const t in e)e[t]=lr(e[t]);return e}function dr(e,t){const n={};for(const r in t)if(t.hasOwnProperty(r)){null!==e&&"object"===typeof e&&e.hasOwnProperty(r)||(n[r]=t[r]);if(null!==t[r]&&null!==e[r]&&!Array.isArray(t[r])&&!Array.isArray(e[r])&&"object"===typeof t[r]&&"object"===typeof e[r]){const o=dr(e[r],t[r]);Object.keys(o).length>0&&(n[r]=o)}else(e[r]!==t[r]||Array.isArray(t[r]))&&(n[r]=t[r]);null===e[r]&&""===t[r]&&delete n[r]}return n}function fr(e,t){if(null===t||"object"!==typeof t||Array.isArray(t))return t;for(const n in t)t.hasOwnProperty(n)&&((e=e||{})[n]=fr(e[n],t[n]));return e}const pr=[{runGetGuestWorkflow:{stepExecution:$n,results:{guestIsLoggedIn:"parseInput",guestIsNotLoggedIn:{}}}},{parseInput:{stepExecution:function(e){const t=kt("workflowData"),n=function(e){return Object.keys(e).filter((function(t){return!("string"!==typeof e[t]||!e[t].trim())})).filter((function(e){for(let t=0;t<rr.length;t++)if(e.startsWith(rr[t]))return;return!0})).reduce((function(t,n){return t[n]=e[n].trim(),t}),{})}((0,u.U2)(t,"guestData")||{}),r=function(e){return Object.keys(e).filter((function(e){return!e.includes("address.")&&!e.includes("phone.")&&"proposedDisplayName"!==e})).reduce((function(t,n){return t.profile[n]=e[n],t}),{profile:{}})}(n);r.profile.addresses=sr(n,"address"),r.profile.phones=sr(n,"phone"),n.proposedDisplayName&&(r.displayName={proposedDisplayName:n.proposedDisplayName}),(0,u.t8)(t,"parsedGuest",r),Nt("workflowData",t),e("success")},results:{success:"prepareUpdate",error:"close"}}},{prepareUpdate:{stepExecution:function(e){const t=kt("workflowData"),n=(0,u.U2)(t,"parsedGuest"),r=(0,u.d9)(n),o=(0,u.U2)(t,"guest"),i=(0,u.U2)(o,"profile.addresses"),s=(0,u.U2)(o,"profile.phones"),a=(0,u.U2)(r,"profile.addresses"),c=(0,u.U2)(r,"profile.phones");Array.isArray(i)&&Array.isArray(a)&&cr(i,a,"addressGuid"),Array.isArray(s)&&Array.isArray(c)&&cr(s,c,"phoneGuid");const l=function(e,t){if("undefined"===typeof e||"undefined"===typeof t)return{};const n=lr((0,u.d9)({profile:dr(e.profile||{},t.profile||{})||{},displayName:dr(e.displayName||{},t.displayName||{})||{}}));Object.keys(n.profile).forEach((function(e){""===n.profile[e]&&(n.profile[e]=null)})),Object.keys(n.displayName).forEach((function(e){""===n.displayName[e]&&(n.displayName[e]=null)})),(0,u.U2)(n.profile,"dateLastModified")&&delete n.profile.dateLastModified;(0,u.U2)(n.profile,"segmentDeletes")&&delete n.profile.segmentDeletes;return function(e,t,n){const r=["line1","line2","line3","postalCode","stateProvince","country","city","type"],o=(0,u.d9)((0,u.U2)(t,"profile.addresses")||[]),i=[],s={};((0,u.U2)(e,"profile.addresses")||[]).forEach((function(e){s[e.addressGuid]=e})),(0,u.U2)(n,"profile.addresses")&&delete n.profile.addresses;Array.isArray(o)&&o.length&&(o.forEach((function(e){const t=e.addressGuid,n={};r.forEach((function(t){n[t]=e[t]?e[t]:null})),"undefined"!==typeof(0,u.U2)(s,[t,"addressGuid"].join("."))&&(n.addressGuid=t,a(n).forEach((function(r){s[t][r]===e[r]&&delete n[r]}))),a(n).length&&i.push(n)})),i.length&&(0,u.t8)(n,"profile.addresses",i));function a(e){return Object.keys(e).filter((function(e){return-1===["preferred","addressGuid","type"].indexOf(e)}))}}(e,t,n),function(e,t,n){if(!(0,u.U2)(n,"profile"))return;"undefined"!==typeof(0,u.U2)(n,"profile.phones")&&delete n.profile.phones;if(Array.isArray((0,u.U2)(t,"profile.phones"))){const i=[];t.profile.phones.forEach((function(t){let n,s;t.phoneGuid&&!t.number?i.push({phoneGuid:t.phoneGuid}):t.number&&t.type&&(n=o(e,t),n?(s=dr(n,t),Object.keys(s).length>0&&(s.phoneGuid=t.phoneGuid,s.type=t.type,i.push(s))):i.push(r({number:t.number,type:t.type,internationalPrefix:t.internationalPrefix,countryCode:t.countryCode})))})),i.length&&(n.profile.phones=i)}function r(e){const t={};return Object.keys(e).forEach((function(n){let o;"object"===typeof e[n]?(o=r(e[n]),Object.keys(o).length>0&&(t[n]=o)):null!=e[n]&&(t[n]=e[n])})),t}function o(e,t){let n;const r=(0,u.U2)(e,"profile.phones");return t.phoneGuid&&r&&(n=r.filter((function(e){return e.phoneGuid===t.phoneGuid}))[0]),n}}(e,t,n),function(e,t,n){const r=(0,u.U2)(e,"marketing");let o=(0,u.U2)(t,"marketing");const i={};if((r||[]).forEach((function(e){i[e.code]=e})),Array.isArray(o)&&o.length&&(o=o.filter((function(e){return e.subscribed!==(0,u.U2)(i,[e.code,"subscribed"].join("."))})),o.length))return n.marketing=o,n.marketing}(e,t,n),function(e,t,n){const r=e.legalAssertions||[],o=[];(t.legalAssertions||[]).forEach((function(e){-1===r.indexOf(e)&&o.push(e)})),o.length>0&&(n.legalAssertions=o)}(e,t,n),Object.keys(n).forEach((function(e){"object"!==typeof n[e]||n[e]&&0!==Object.keys(n[e]).length||delete n[e]})),n}(o,r);if(Array.isArray((0,u.U2)(l,"profile.addresses"))){ar(l.profile.addresses);const e=l.profile.addresses.filter(ur);e.length>0?l.profile.addresses=e:delete l.profile.addresses}Array.isArray((0,u.U2)(l,"profile.phones"))&&ar(l.profile.phones),(0,u.t8)(t,"modifiedGuest",l),Nt("workflowData",t),e("success")},results:{success:"execute"}}},{execute:{stepExecution:function(e){const t=kt("workflowData"),n=(0,u.U2)(t,"guest"),r=(0,u.U2)(n,"etag"),o={...(0,u.U2)(t,"modifiedGuest"),etag:r},i=(0,u.U2)(n,"profile.swid"),s=(0,u.U2)(n,"token.access_token"),a=Ue.API_SET_PPC;return(0,u.t8)(t,"isUpdateSuccessful",!1),Dt.guestUpdateBySWID({guest:o,swid:i,accessToken:s,etag:r,eventName:a}).then((r=>{const i=(0,u.U2)(r,"error.keyCategory");if((0,u.t8)(t,"response",r),!r.data||null!==r.error&&"ADVISORY"!==i)Nt("workflowData",t),e("done");else{(0,u.U2)(t,"hasUpdateBeenCalled")||(0,u.t8)(t,"hasUpdateBeenCalled",!0);const i=(s=n,a=r.data,a=(0,u.d9)(a),Object.keys(a||{}).forEach((function(e){null===(0,u.U2)(a,e)&&(0,u.U2)(s,e)&&(0,u.t8)(a,e,s[e])})),(0,u.t8)(s,"etag",(0,u.U2)(a,"etag")),s.profile=fr(s.profile,a.profile),s.displayName=fr(s.displayName,a.displayName),s.marketing=fr(s.marketing,a.marketing),s);(0,u.t8)(t,"guest",i),(0,u.t8)(t,"isUpdateSuccessful",!0),(0,u.t8)(t,"isMobilePhoneChanged",!!function(e,t){t=(t||"").toUpperCase(),e=e||[];for(let n=0;n<e.length;n++)if(e[n].type.toUpperCase()===t)return e[n]}((0,u.U2)(o,"profile.phones"),"MOBILE")),Nt("workflowData",t),e("done")}var s,a}),(n=>{(0,u.t8)(t,"response",n),Nt("workflowData",t),e("done")}))},results:{done:"formatOutput"}}},{formatOutput:{stepExecution:function(e){const t=kt("workflowData"),n=(0,u.U2)(t,"response"),r=(0,u.U2)(n,"error.keyCategory"),o=Ot(n),i=(0,u.U2)(t,"guest");return o.length&&"ACTIONABLE_INPUT"===r?i.errors=Tt(o):o.length&&"ADVISORY"!==r?(delete i.data,i.failures=o,(0,u.t8)(t,"isUnresolvableError",!0)):n.isNetworkError&&(delete i.data,(0,u.t8)(t,"isUnresolvableError",!0),i.failures=[{category:"SERVICE_ERROR",code:"NETWORK_FAILURE"}]),(0,u.t8)(t,"output",i),Nt("workflowData",t),Promise.resolve(e())},results:{}}}];function hr(e,t){return(e=e||[]).reduce(((e,n)=>("undefined"===typeof e[n[t]]&&(e[n[t]]=n),e)),{})}function gr(e){if((e=e||{})&&"EDITABLE"===e.editable){const t=e.type||{};return Object.keys(t).reduce(((e,n)=>{const r=t[n]||{};return e[n]=Object.keys(r).reduce(((e,t)=>("EDITABLE"===r[t].editable&&"type"!==t&&(e[t]=null),e)),{}),e}),{})}return null}function Er(e){const t=e.existingProfile[e.type]||e.template[e.type]||e.template.DEFAULT||null,n=e.config[e.type]||e.config.DEFAULT||null;return t&&n&&Object.keys(t).forEach((r=>{if(e.allowedFields.indexOf(r)>-1){const o=e.fieldName.split(".");o.push(r);const i=o.join(".");e.editableProfile.data[i]=t[r]||null,e.editableProfile.required[i]=(n[r]||{}).required||!1}})),e.editableProfile}const mr=[{runGetGuestWorkflow:{stepExecution:$n,results:{guestIsLoggedIn:"getEditableAndRequiredFields",guestIsNotLoggedIn:{}}}},{getEditableAndRequiredFields:{stepExecution:function(e){const t=kt("guest");let n={data:{},required:{}};try{Ze().then((r=>{const o=nr,i="compliance.ageBands."+t.profile.ageBand+".UPDATE",s=(0,u.U2)(r,i),a=hr(t.profile.addresses,"type"),c=hr(t.profile.phones,"type"),l=gr((0,u.U2)(r,i+".addresses")),d=gr((0,u.U2)(r,i+".phones")),f=(0,u.U2)(r,"displayName"),p=(0,u.U2)(f,"enabled");for(const e of o){const r=(e.split(".")[1]||"").toUpperCase();e.includes("address")&&s.addresses?n=Er({existingProfile:a,template:l,config:s.addresses.type,allowedFields:or,fieldName:e,editableProfile:n,type:r}):e.includes("phone")&&s.phones?n=Er({existingProfile:c,template:d,config:s.phones.type,allowedFields:ir,fieldName:e,editableProfile:n,type:r}):e.toLowerCase().includes("displayname")&&p?n.data[e]=(0,u.U2)(t,"displayName."+e):s[e]&&(n.data[e]=(0,u.U2)(t,"profile."+e),n.required[e]=(0,u.U2)(s,e).required||!1)}return Nt("editableFields",n),Promise.resolve(e())}))}catch(e){Nt("editableFields",{error_codes:ht,data:{}})}},results:{}}}],_r=1e3;function yr(e,t){let n=this;this.start=e,this.end=t,this.getPercentElapsed=function(e){let t;if(!(e instanceof Date))return null;return t=n.end.getTime()-n.start.getTime(),(e.getTime()-n.start.getTime())/t},this.getSecondsRemaining=function(e){if(!(e instanceof Date))return null;return(n.end.getTime()-e.getTime())/_r},this.getDateAtPercent=function(e){let t=n.end.getTime()-n.start.getTime();return new Date(n.start.getTime()+e*t)},this.getDateNearestToMultipleOfSeconds=function(e){if(e<=0)return null;let t=(n.end.getTime()-n.start.getTime())/_r,r=Math.ceil(t/e)*e;return new Date(n.start.getTime()+r*_r)}}let Ir={};function wr(e){"undefined"===typeof e?Ir={}:Ir[e]=0}function Rr(e){return Ir[e]||0}let Tr={VALID:1,REFRESH_WINDOW:2,EXPIRED:3};function Or(e){let t=this;this.data=e||{},this.getNextRefreshAttempt=function(e){i.log("Token#getNextRefreshAttempt");let d=new Date(t.data.created),f=new Date(t.data.expires);if(!(0,u.qb)(d)||!(0,u.qb)(f))return void i.error("Invalid created or expires date in token object");let p,h,g=new yr(d,f),E=g.getPercentElapsed(e),m=g.getSecondsRemaining(e),_=new yr(e,g.end);if(E>1){let t=Rr(Tr.EXPIRED),n=new yr(g.end,e);h=Tr.EXPIRED,i.debug("Token currently expired. Retries already attempted within this interval: "+t),t<c?(i.debug("token should be refreshed immedietly"),p=e):(i.debug("Too many attempts made within this interval. Get time nearest to interval of "+l+" (round up)"),wr(),p=n.getDateNearestToMultipleOfSeconds(l))}else if(E>=r&&E<1||m<=o&&t.data.ttl>=a)h=Tr.REFRESH_WINDOW,0===Rr(Tr.REFRESH_WINDOW)?(i.debug("Token is active, we are within the token refresh window and a refresh attempt has not yet been made. Refresh immedietly."),p=e):(i.debug("Token is active, we are within the token refresh window, and an attempt has already been made."),p=_.getDateAtPercent(s));else{i.debug("Valid token"),h=Tr.VALID;let e=g.getDateAtPercent(r).getTime(),s=t.data.ttl<=a?e:g.end.getTime()-o*n;p=new Date(Math.min(e,s))}return{date:p,state:h}},this.isValid=function(){return"string"===typeof t.data.access_token&&"string"===typeof t.data.swid&&"number"===typeof t.data.ttl},this.isExpired=function(){let e=new Date(t.data.expires).getTime();return!t.isValid()||isNaN(e)||e<new Date(Date.now()).getTime()};const n=1e3,r=.9,o=300,s=.5,a=480,c=3,l=300}Or.TOKEN_LIFECYCLE_STATE=Tr;const Ar=0,vr=1;function Nr(){return new Promise((e=>{const{clientId:t}=U(),n=we();pe.then((r=>r.call("responder","get.cookie",`${t}-${n}.${q}`).then((t=>{if(null===t)return e({state:!1});let n=Date.parse(t)-Date.now();e({state:n<1?Ar:vr,timeLeft:n})})).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-lib-cookies-trustState)",[Ue.STACK_TRACE]:t})}))))}))}function kr(){const{clientId:e}=U(),t=we();return pe.then((n=>n.call("responder","delete.cookie",{key:`${e}-${t}.${q}`}).catch((e=>{const t=(0,u.U2)(e,"message");i.error(`Error in PatchBay call: ${t}`),Ye({[Ue.ACTION_NAME]:Ue.LOG_PATCHBAY_ERROR,[Ue.INFO]:"location(outer-lib-cookies-trustState)",[Ue.STACK_TRACE]:t})}))))}let Cr;function br(){return i.log("TrustState#watch"),Nr().then((e=>{if(Sr(),(0,u.U2)(e,"state")===Ar)return i.info("In low trust"),Pr(),void kr();!function(e=Ce){Cr=setTimeout((()=>{Pr(),kr()}),e)}((0,u.U2)(e,"timeLeft"))})).catch((()=>{Pr(),Sr()}))}function Sr(){clearTimeout(Cr),Cr=void 0}function Pr(){Xe(Nn)}const Lr={INITIALIZATION:Mn,GET_GUEST:bn,GUEST_FLOW:Vn,GET_INLINE_NEWSLETTERS:er,SET_INLINE_NEWSLETTERS:tr,GET_EDITABLE_AND_REQUIRED_FIELDS:mr,SESSION_STATE_TASKS:[{checkState:{stepExecution:function(e){const t=()=>{if(!0===kt("wasLoggedIn"))return e("syncLoggedOut");e()};return be().then((n=>{if(!n)return t();Nt("loggedIn",!0);let r=new Or(n).getNextRefreshAttempt(new Date(Date.now()));if(Nt("nextRefreshAttempt",r),!1===kt("wasLoggedIn"))return e("syncLoggedIn");let o=kt("originalRefreshToken");if(o||(Nt("originalRefreshToken",n.refresh_token),o=n.refresh_token),o!==n.refresh_token||new Date(Date.now())>=(r.date||new Date(Date.now())))return e("tokenRefresh");e()})).catch(t)},results:{syncLoggedIn:"syncLoggedIn",syncLoggedOut:"syncLoggedOut",tokenRefresh:"tokenRefreshSubflow"}}},{tokenRefreshSubflow:{stepExecution:Fn,results:{done:"incrementOrResetRefreshCounter"}}},{incrementOrResetRefreshCounter:{stepExecution:function(e){if(kt("tokenRefreshed"))wr(),Ct("tokenRefreshed");else{const e=kt("nextRefreshAttempt")||{};t=e.state,Ir[t]=(Ir[t]||0)+1,Ir[t]}var t;e()},results:{}}},{syncLoggedIn:{stepExecution:function(e){return Promise.all([_n(),pe]).then((([t,n])=>n.call("inner","setGuest",t).then((()=>{n.call("inner","reloadConfigFromBundlerIfChanged");const r=(0,u.U2)(t,"profile.ageBand")===It;W((0,u.U2)(t,"profile.swid"),r),Xe(An,t),br(),Nt("loggedIn",!0),e()})))).catch(e)},results:{}}},{syncLoggedOut:{stepExecution:function(e){const t=K();return pe.then((n=>n.call("inner","guest.logout").then((()=>{Sr(),Ye({[Ue.ACTION_NAME]:Ue.EVENT_LOGOUT,[Ue.INFO]:"type(mismatchtimer)"}),t&&t.startsWith("{")&&W((0,u.Vj)()),Xe(vn),bt(),Nt("loggedIn",!1),e()})).catch(e)))},results:{}}}],SET_PPC:pr,TOKEN_REFRESH:xn};function Dr({name:e,step:t=null,workflowOptions:n=null,onComplete:r=null,persistWorkflowOptions:o=!1}){n&&Nt("workflowOptions",n);new De(e,Lr[e],t,(()=>{o||Ct("workflowOptions"),r&&r()})).runWorkflow()}const Ur={LOCAL:"https://qa.registerdisney.go.com/jgc/v8",DEV:"https://qa.registerdisney.go.com/jgc/v8",QA:"https://qa.registerdisney.go.com/jgc/v8",STAGE:"https://stg.registerdisney.go.com/jgc/v8",VAL:"https://stg.registerdisney.go.com/jgc/v8",PROD:"https://registerdisney.go.com/jgc/v8"};let Gr;function xr(){Nt("sessionTimerPaused",!0),clearTimeout(Gr)}function Fr(e){Nt("sessionTimerPaused",!1),Nt("loggedIn",e),Mr()}function Mr(){clearTimeout(Gr),Nt("wasLoggedIn",kt("loggedIn")||!1),Dr({name:"SESSION_STATE_TASKS",onComplete:()=>{Gr=setTimeout(Mr,ke)},persistWorkflowOptions:!0})}var Vr=n(486),$r=n.n(Vr);const jr="//cdn.unid.go.com/js/unid.min.js";let Br,qr,Wr;function Kr(e=""){i.debug(`api/init: innerVersion "${e}"`),i.debug(`api/init: window.ONEID_WEB_SDK_VERSION "${window.ONEID_WEB_SDK_VERSION}"`),e!==window.ONEID_WEB_SDK_VERSION&&Ye({[Ue.ACTION_NAME]:Ue.LOG_VERSION_MISMATCH,[Ue.INFO]:`outer(${window.ONEID_WEB_SDK_VERSION}),inner(${e})`}),Wr=!0,qr()}function Hr(){return Wr}function Yr(){if(Wr){if(Xe(Tn,xt),window.ONEID_WEB_SDK_MIGRATION){const e=$r().defer();return e.reject(xt),e.promise}return Promise.reject(xt)}qe({conversationId:(0,u.Vj)()});const e=Ke(Ue.API_INIT),t=ln(9e4),n=function(){const e=new Promise((e=>{const t=an.createInner();t.onload=()=>{e(t)}})),t=new Promise((e=>{const t=an.createResponder();t.onload=()=>{e(t)}}));return Promise.all([e,t])}().then(zr).then(Qr).then(Xr),r=Promise.race([n,t]).then((()=>new Promise((n=>{((0,u.U2)(U(),"debug")||{}).tealiumDebug&&pe.then((e=>e.message("inner","turnOnDebugTealiumTracking")));const r=we()||"PROD",o=U()||{},s=o.clientId,a=o.langPref;var c;c={clientId:`${s}-${r}`,endpoint:Ur[r],language:a},Lt={...Lt,...c},Dr({name:"INITIALIZATION",onComplete:function(){t.cancel(),i.debug("OneID initialization complete"),e.send();const r=kt("guest"),o={loggedIn:!!(r||{}).token,guest:r||null};var s;Xe(On,o),bt(),s=o.loggedIn,i.log("SessionTimer#startTimer"),Nt("loggedIn",s),Mr(),o.loggedIn&&br(),n(o)}.bind(this)})})))).catch((({errorCodes:t,errorCategory:n})=>(e.send({[Ue.ERROR_CATEGORY]:n||tn,[Ue.ERROR_CODES]:t||Xt}),Xe(Tn,`${Xt}: ${t}`),Promise.reject(`${Xt}: ${t}`))));if(window.ONEID_WEB_SDK_MIGRATION){const e=$r().defer();return r.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return r}function zr([e,t]=frames){return new Promise(((n,r)=>{const o={frames:{outer:{window,origin:window.origin||window.location&&window.location.origin,channels:["inner","responder"]},inner:{window:e.contentWindow,origin:new URL(e.src).origin,channels:["outer","responder"]},responder:{window:t.contentWindow,origin:new URL(t.src).origin,channels:["inner","outer"]}}};Promise.all([ue(o),pe]).then((()=>{i.debug("Cross frame communication initialized"),n()})).catch((()=>r({errorCodes:Mt})))}))}function Qr(){return Br}function Xr(){return new Promise((e=>{Ze().then((t=>{let n=(0,u.U2)(t,"uiConfig.audience");if(!n||"PK"===n)return e();"GA"===n&&(!function(){let e=(0,u.U2)(U(),"clientId"),t=document.createElement("script");t.type="text/javascript",t.id="unid",t.setAttribute("data-client",e),t.src=jr,document.body.appendChild(t),i.debug("UNID loaded")}(),Ye({[Ue.ACTION_NAME]:Ue.LOG_UNID_INIT})),e()})).catch((t=>{i.debug("Could not configure UNID due to failed call to get site config from inner"),Ye({[Ue.ERROR_CATEGORY]:tn,[Ue.INFO]:JSON.stringify(t),[Ue.ACTION_NAME]:Ue.LOG_UNID_INIT}),e()}))}))}Br=new Promise((e=>qr=e)),Wr=!1;const Zr="EMAIL_VERIFICATION_CALLBACK",Jr="LICENSE_PLATE_CALLBACK",eo="REAUTH_CALLBACK",to="EMAIL_VERIFICATION",no="IDENTITY_FLOW",ro="LICENSE_PLATE",oo="LOGIN",io="NEWSLETTERS",so="REAUTH",ao="REGISTRATION",co="UPDATE_PROFILE",uo={doNotDisturb:No({preConditions:[_o],method:function([e]){if("boolean"!==typeof e)return Promise.reject({errorCodes:jt});return Gn(e),Promise.resolve()},actionName:Ue.API_SET_DO_NOT_DISTURB,logInfoKey:"flag"}),forceTokenRefresh:No({preConditions:[_o,Eo],method:function([e]){Ct("tokenRefreshResponse"),qe(e);const t=ko(),n=new Promise((e=>{Dr({name:"TOKEN_REFRESH",step:"forceRefresh",onComplete:()=>{const t=kt("tokenRefreshResponse"),n=(0,u.U2)(t,"data.token"),r=(0,u.U2)(t,"error.keyCategory")||"",o=[];((0,u.U2)(t,"error.errors")||[]).forEach((e=>{o.includes(e.code)||o.push(e.code)})),Ct("tokenRefreshResponse"),e({errorCategory:r,errorCodes:o,newTokens:n})}})}));return Promise.race([n,t]).then((({errorCategory:e,errorCodes:n,newTokens:r})=>(t.cancel(),r?Promise.resolve(r):e||n.length?Promise.reject({errorCategory:e,errorCodes:n.join(",")}):(Ye({[Ue.ACTION_NAME]:Ue.LOG_APPLICATION_ERROR,[Ue.ERROR_CATEGORY]:tn,[Ue.INFO]:"api(forceTokenRefresh),data(missing_tokens,no_errors)"}),Promise.reject({errorCategory:tn,errorCodes:nn})))))},actionName:Ue.API_FORCE_TOKEN_REFRESH}),getEditableProfileFields:No({preConditions:[_o,Eo],method:function([e]){qe(e);const t=ko(),n=un().then(_n).then((t=>new Promise((n=>{Dr({name:"GET_EDITABLE_AND_REQUIRED_FIELDS",workflowOptions:dn(e,t),onComplete:n})})))).then((()=>{const e=kt("editableFields");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()}));return Promise.race([n,t]).then((()=>{t.cancel();const e=kt("editableFields");return Promise.resolve(e)}))},actionName:Ue.API_GET_PPC}),getGuest:No({preConditions:[_o,Eo],method:function(e){const[t=!1,n={}]=e,r=!0===t;qe(n);const o=ko(),i=un().then((()=>new Promise(((e,t)=>{let o={forceRefresh:(0,u.U2)(n,"forceRefresh")||!1,fullPayloadRequested:!!r};Dr({name:"GET_GUEST",workflowOptions:dn(n,o),onComplete:()=>{const n=kt("getGuestResponse");if(Ct("getGuestResponse"),n){const r=(0,u.U2)(n,"error.keyCategory")||"FAILURE_BY_DESIGN";let i=[];return(0,u.U2)(n,"error.errors")&&(0,u.U2)(n,"error.errors").forEach((function(e){-1===i.indexOf(e.code)&&i.push(e.code)})),i=i.length?i.join(","):"UNABLE_TO_RETRIEVE_GUEST_DATA",o.localCopyReturned=!1,kt("logoutType")?t({errorCodes:i,errorCategory:r,[Ue.INFO]:o}):(0,u.U2)(n,"data.profile")?e(kt("guest")||null):t({errorCodes:i,errorCategory:r,[Ue.INFO]:o})}e(kt("guest")||null)}})}))));return Promise.race([i,o]).then((e=>(o.cancel(),Promise.resolve(e))))},actionName:Ue.API_GET_GUEST_DATA,logInfoKey:"fullPayload"}),getGuestNewsletters:No({preConditions:[_o,Eo],method:function([e]){qe(e);const t=ko(),n=_n().then((e=>(0,u.U2)(e,"marketing")||null));return Promise.race([n,t]).then((e=>(t.cancel(),Promise.resolve(e))))},actionName:Ue.API_GET_GUEST_NEWSLETTERS}),getInlineNewsletters:No({preConditions:[_o],method:function(e){const[t,n]=e;qe(n);const r=ko(),o=Ze().then((e=>e?Ro(e,t)?Promise.reject({errorCodes:Qt}):Promise.resolve():Promise.reject({errorCodes:zt}))).then((()=>new Promise((e=>{Dr({name:"GET_INLINE_NEWSLETTERS",workflowOptions:dn(n,{promotionId:t}),onComplete:e})})))).then((()=>{const e=kt("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()}));return Promise.race([o,r]).then((()=>{r.cancel();const e=kt("responsePayload");return Promise.resolve(e)}))},actionName:Ue.API_GET_INLINE_NEWSLETTERS,logInfoKey:"promotionId"}),getTrustStateStatus:No({preConditions:[_o,Eo],method:function([e]){qe(e);const t=ko();let n;const r=Nr().then((({state:e})=>n=e));return Promise.race([r,t]).then((()=>(t.cancel(),Promise.resolve(n))))},actionName:Ue.API_GET_TRUST_STATE_STATUS}),init:Yr,getConfig:function(){return lo},getLicensePlateDataBag:No({preConditions:[_o],method:function([e={},t]){qe(t);const{pairingCode:n=""}=e;if(!n||0===n.length)return Promise.reject({errorCodes:qt});return Nt("workflowOptions",dn(t)),rn(n)},actionName:Ue.API_GET_LICENSE_PLATE_DATA_BAG}),getLoggedInStatus:No({preConditions:[()=>Br],method:yo,actionName:Ue.API_GET_LOGGED_IN_STATUS}),launchEmailVerification:No({preConditions:[_o,Eo],method:function([e]){return qe(e),new Promise(((t,n)=>{const r="EMAIL_ALREADY_VERIFIED";un().then(_n).then((t=>{if(t.profile.emailVerified)throw new Error(r);return pe.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:Zr},guest:t,name:to,workflowOptions:dn(e)})))})).then((()=>{R(Zr,(({errorCategory:e,errorCodes:r,wasSuccess:o})=>{T(Zr),o?t():n({errorCategory:e,errorCodes:r})})),an.showLightbox()})).catch((e=>{T(Zr),e.message!==r?n(new Error(nn)):t()}))}))},actionName:Ue.API_LAUNCH_EMAILVERIFICATION,newRelicFlowName:(0,u.hK)(to)}),launchGuestFlow:No({preConditions:[_o,mo],method:function([e,t]){qe(t);const n=ko(),r=new Promise((n=>{Dr({name:"GUEST_FLOW",workflowOptions:dn(t,{guestFlowEmail:e}),onComplete:n})}));return Promise.race([r,n]).then((()=>{const e=`SUCCESS_LAUNCH_${kt("guestFlowName")}_${kt("guestFlowEmail")?"WITH":"WITH_OUT"}_EMAIL`;return n.cancel(),Ct("guestFlowCode"),Ct("guestFlowName"),Ct("guestFlowEmail"),Promise.resolve(e)}))},actionName:Ue.API_LAUNCH_GUESTFLOW}),launchIdentityFlow:No({preConditions:[_o,mo],method:function([e,t]){qe(t);const n=ko(),r=un().then((()=>{let n=dn(t);const r={name:no,workflowOptions:n,workflowData:{isIdentityFlow:!0}};return e&&(r.workflowData.loginValue=e,r.workflowData.skipPrompt=!0),pe.then((e=>e.call("inner","runWorkflow",r)))}));return Promise.race([r,n]).then((()=>(n.cancel(),an.showLightbox(),Promise.resolve())))},actionName:Ue.API_LAUNCH_IDENTITYFLOW,newRelicFlowName:(0,u.hK)(no)}),launchLicensePlate:No({preConditions:[_o],method:function([e={}]){qe(e);const{pairingCode:t="",authenticationFlow:n,deviceName:r,isLicensePlateLaunched:o=!0,showSuccessScreen:i}=e;if(!t||0===t.length)return Promise.reject({errorCodes:qt});return new Promise(((s,a)=>{xr(),un().then(_n).then((s=>pe.then((a=>a.call("inner","runWorkflow",{apiCallback:{name:Jr},guest:s,name:ro,workflowData:{authenticationFlow:n,deviceName:r,isLicensePlateLaunched:o,pairingCode:t,showSuccessScreen:i},workflowOptions:dn(e)}))))).then((()=>{R(Jr,(({errorCodes:e=ht,wasSuccess:t=!1})=>{if(T(Jr),yo().then((e=>Fr(e))),t)return s();a({errorCategory:_t,errorCodes:e})})),an.showLightbox()})).catch((()=>{yo().then((e=>Fr(e))),a(new Error(nn))}))}))},actionName:Ue.API_LAUNCH_LICENSE_PLATE,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(ro)}),launchLogin:No({preConditions:[_o,mo],method:function([e]){qe(e);const t=ko(),n=un().then((()=>{let t=dn(e);const n={name:oo,workflowOptions:t},r=(0,u.U2)(e,"optionalConfigs.email");return r&&(n.workflowData={loginValue:r}),pe.then((e=>e.call("inner","runWorkflow",n)))}));return Promise.race([n,t]).then((()=>(t.cancel(),an.showLightbox(),Promise.resolve())))},actionName:Ue.API_LAUNCH_LOGIN,newRelicFlowName:(0,u.hK)(oo)}),launchNewsletters:No({preConditions:[_o],method:function(e){const[t,n]=e;qe(n);const r=ko();let o;const i=_n().then((e=>(o=e,Ze()))).then((e=>e?Ro(e,t)?Promise.reject({errorCodes:jt}):Promise.resolve(t):Promise.reject({errorCodes:zt}))).then((e=>pe.then((t=>{let r=dn(n,{promotionId:e});t.call("inner","runWorkflow",{guest:o,name:io,workflowOptions:r})}))));return Promise.race([i,r]).then((()=>(r.cancel(),an.showLightbox(),Promise.resolve())))},actionName:Ue.API_LAUNCH_NEWSLETTERS,logInfoKey:"promotionId",newRelicFlowName:(0,u.hK)(io)}),launchProfile:No({preConditions:[_o,Eo],method:function([e]){qe(e);const t=ko();let n=dn(e);const r=un().then(_n).then((e=>pe.then((t=>t.call("inner","runWorkflow",{guest:e,name:co,workflowOptions:n})))));return Promise.race([r,t]).then((()=>(t.cancel(),an.showLightbox(),Promise.resolve())))},actionName:Ue.API_LAUNCH_PROFILE,newRelicFlowName:(0,u.hK)(co)}),launchReauth:No({preConditions:[_o,Eo],method:function([e]){return qe(e),new Promise(((t,n)=>{un().then(_n).then((t=>pe.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:eo},guest:t,name:so,workflowOptions:dn(e)}))))).then((()=>{R(eo,(({errorCodes:e=ht,wasSuccess:r=!1})=>{if(T(eo),r)return Ct("tokenData"),_n().then((e=>t(e)));n({errorCategory:_t,errorCodes:e})})),an.showLightbox()})).catch((()=>n(new Error(nn))))}))},actionName:Ue.API_LAUNCH_REAUTH,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(so)}),launchRegistration:No({preConditions:[_o,mo],method:Ao,actionName:Ue.API_LAUNCH_REGISTRATION,newRelicFlowName:(0,u.hK)(ao)}),logout:No({preConditions:[_o,Eo],method:function(){const{clientId:e}=U(),t=we(),n=ko();Sr(),xr();const r=_n().then((n=>{bt();const r=(0,u.U2)(n,"profile.swid"),o=(0,u.U2)(n,"token");return mn(),r&&o?(Pt().then((e=>{const{s2CookieName:t,s2Domain:n}=e,r=_.getCookieDomain();E(t,n,"/"),r&&E(t,r,"/")})),Rn(r,o).then((()=>pe.then((n=>(n.message("inner","guest.logout"),W((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`))))))):(Ye({[Ue.ACTION_NAME]:Ue.LOG_MISSING_GUEST_DATA_ON_LOGOUT,[Ue.INFO]:`swid(${r?"present":"missing"}),tokens(${o?"present":"missing"})`}),pe.then((n=>(n.message("inner","guest.logout"),W((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`)))))}));return Promise.race([r,n]).then((()=>(Fr(!1),n.cancel(),Xe(vn),Promise.resolve())))},actionName:Ue.API_LOGOUT}),on:R,off:T,redeemSessionTransferKey:()=>{},setEditableProfileFields:No({preConditions:[_o,Eo],method:function(e){const[t,n]=e;if(qe(n),0===Object.keys(t).length)return Promise.reject({errorCodes:Ht});const r=/^phone\.mobile/;if(Object.keys(t).find((e=>r.test(e))))return Promise.reject({errorCodes:Zt});const o=ko(),i=un().then(_n).then((e=>{const n=dn(e);return Nt("workflowData",{guestData:t,guest:e}),new Promise((e=>{Dr({name:"SET_PPC",workflowOptions:n,onComplete:e})}))})).then((()=>{const e=kt("workflowData").output;return e.failures&&e.failures.length>0?Promise.reject({success:!0,error_codes:(0,u.U2)(e,"failures[0].code")}):Promise.resolve()})).catch((e=>{Promise.reject(e)}));return Promise.race([i,o]).then((()=>{o.cancel();const e=kt("workflowData").output;return In({guest:e,token:e.token},!0),Promise.resolve({data:e})})).catch((function(e){return Promise.reject({error_codes:e})}))},actionName:Ue.API_SET_PPC}),setInlineNewsletters:No({preConditions:[_o],method:function(e){const[t,n]=e;if(qe(n),!e||!t)return Promise.reject({errorCodes:Ht});const r=ko(),o=Ze().then((e=>e?Ro(e,t.campaignId)?Promise.reject({errorCodes:Hn}):new Promise((e=>{Dr({name:"SET_INLINE_NEWSLETTERS",workflowOptions:dn(n,{buData:t}),onComplete:e})})):Promise.reject({errorCodes:zt}))).then((()=>{const e=kt("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve(e)}));return Promise.race([o,r]).then((()=>(r.cancel(),Promise.resolve())))},actionName:Ue.API_SET_INLINE_NEWSLETTERS}),setLogLevel:function(t,n){if("string"!==typeof t||!e[t.toUpperCase()])return void i.warn(jt);const r=e[t.toUpperCase()];s(r),pe.then((e=>e.broadcast("config.setLogLevel",r))),n&&r!==e.OFF?m(h,t,null,"/"):n&&r!==e.OFF||E(h,null,"/")}};let lo;const fo={get:wo},po={get:(ho=wo,go=Vt,"function"===typeof ho?function(...e){return i.warn(go),ho.apply(this,e)}:ho)};var ho,go;function Eo(){return new Promise(((e,t)=>{yo().then((n=>{if(n)return e();t({errorCategory:tn,errorCodes:en})}))}))}function mo(){return new Promise(((e,t)=>{yo().then((n=>{if(!n)return e();t({errorCategory:tn,errorCodes:Jt})}))}))}function _o(){return new Promise(((e,t)=>{if(Hr())return e();t({errorCategory:tn,errorCodes:Xt})}))}function yo(){return be().then((e=>!!e&&!e.isExpired)).catch((()=>!1))}function Io(e){return"string"!==typeof e||!e.length}function wo(e){i.debug("JS SDK get() was called with the following configuration:",e);const t=!!U(),n=(0,u.d9)(e),r=[];if(n&&t)throw new Error(Ft);if(!t){if(!n||!Object.keys(n).length)throw new Error(Kt);if(!n.clientId||"string"!==typeof n.clientId)throw new Error(Wt);if(!n.responderPage)throw new Error(Yt);let e="";try{e=new URL(n.responderPage)}catch(e){throw new Error(`${jt}: responderPage`)}const t=(0,u.KT)(window.location.hostname),c=(0,u.KT)(e.hostname);t!==c&&(i.warn("responder page domain does not match the top window domain. responder domain:",c),r.push("responderPage")),n.hasOwnProperty("langPref")&&(Io(a=n.langPref)||!f.test(a))&&(i.warn("invalid config.langPref passed to get(config) - it is being ignored."),r.push("langPref"),delete n.langPref),n.hasOwnProperty("cssOverride")&&("string"!==typeof(s=n.cssOverride)||!s.startsWith("http")&&0!==s.length)&&(i.warn("invalid config.cssOverride passed to get(config) - it is being ignored."),r.push("cssOverride"),delete n.cssOverride),n.hasOwnProperty("experience")&&(Io(o=n.experience)||!/^[A-Z0-9.\-_]+.EXP$/.test(o))&&(i.warn("invalid config.experience passed to get(config) - it is being ignored."),r.push("experience"),delete n.experience);const l=/-(DEV|VALID|QA|STAGE|PROD)$/;l.test(n.clientId)&&(i.warn("passing environment as part of the Client ID is deprecated - it is being ignored."),r.push("clientId"),n.clientId=n.clientId.replace(l,"")),function(e){L=(0,u._A)((0,u.d9)({...D,...e}))}(n),lo=(0,u._A)((0,u.d9)(n)),function(e){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"experience");t&&!ze(t)&&(i.warn("optionalConfigs.reporting does not pass validation, values will be ignored"),t=null),n&&!Qe(n)&&(i.warn("experience does not pass validation, values will be ignored"),n=null),(t||n)&&(Ve={reporting:t,...n&&{experience:n}})}(lo),!0===n.initialize&&Yr(),r.length&&Ye({[Ue.ACTION_NAME]:Ue.LOG_INVALID_OID_CONFIG,[Ue.INFO]:r.join(",")})}var o,s,a;window.ONEID_WEB_SDK_MIGRATION&&(uo.launchSocialRegistration=No({preConditions:[_o,mo],method:Ao,actionName:Ue.API_LAUNCH_SOCIAL_REGISTRATION}),uo.getInlineNewsletters=To,uo.setInlineNewsletters=Oo);const c=(0,u.d9)(uo);return(0,u.U2)(U(),"debug.experimentalFeatures")||delete c.redeemSessionTransferKey,R(Tn,(e=>i.error(e))),c}function Ro(e,t){if(!t)return!0;let n=!0,r=e.newsletters;return i.debug("newslettersConfig :",r),Object.keys(r).forEach((function(e){let o=r[e]||{};-1!==Object.keys(o).indexOf(t)&&(n=!1)})),n}function To(e,t){const n=Ke(Ue.API_GET_INLINE_NEWSLETTERS),r=`promotionId(${e})`;if(qe(t),!Hr())return n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:Xt,[Ue.INFO]:r}),Xe(Tn,Xt),Promise.reject({data:{},error_codes:Xt});const o=Co(n,r,$t),i=Ze().then((t=>t?Ro(t,e)?(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:Qt,[Ue.INFO]:r}),Xe(Tn,Qt),Promise.reject({data:{},error_codes:Hn})):Promise.resolve():(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:zt,[Ue.INFO]:r}),Xe(Tn,zt),Promise.reject({data:{},error_codes:zt})))).then((()=>new Promise((n=>{Dr({name:"GET_INLINE_NEWSLETTERS",workflowOptions:dn(t,{promotionId:e}),onComplete:n})})))).then((()=>{const e=kt("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:e.error_codes,[Ue.INFO]:r}),Xe(Tn,e.error_codes),e.data={},Promise.reject(e)):Promise.resolve()}));return Promise.race([i,o]).then((()=>{o.cancel(),n.send({[Ue.INFO]:r});const e=kt("responsePayload");return Promise.resolve(e)}))}function Oo(e,t){const n=Ke(Ue.API_SET_INLINE_NEWSLETTERS);if(qe(t),!Hr())return n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:Xt}),Xe(Tn,Xt),Promise.reject({data:{},error_codes:Xt});if(!e)return n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:Ht}),Xe(Tn,Ht),Promise.reject({data:{},error_codes:Kn});const r=Co(n,void 0,{data:{},error_codes:$t}),o=Ze().then((t=>t?Ro(t,e.campaignId)?(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:Hn}),Promise.reject({data:{},error_codes:Hn})):Promise.resolve():(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:zt}),Xe(Tn,zt),Promise.reject({data:{},error_codes:zt})))).then((()=>new Promise((n=>{Dr({name:"SET_INLINE_NEWSLETTERS",workflowOptions:dn(t,{buData:e}),onComplete:n})})))).then((()=>{const e=kt("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:e.error_codes}),Xe(Tn,e.error_codes),Promise.reject(e)):Promise.resolve(e)}));return Promise.race([o,r]).then((()=>{r.cancel();const e=kt("responsePayload");return Promise.resolve(e)}))}function Ao(e){const[t]=e;qe(t);const n=ko();let r=dn(t),o={name:ao,workflowOptions:r},i=(0,u.U2)(t,"optionalConfigs.providedProfile");i&&(o.guestChanges={profile:i});const s=un().then((()=>pe.then((e=>{e.call("inner","runWorkflow",o)}))));return Promise.race([s,n]).then((()=>(n.cancel(),an.showLightbox(),Promise.resolve())))}function vo(e){return(0,e[0])().then((()=>{if(e.shift(),e.length)return vo(e)}))}function No({preConditions:e=[()=>Promise.resolve()],method:t,actionName:n,newRelicFlowName:r,logInfoKey:o="",sendAfterPreconditions:i=!1}){return(...s)=>{const a=Ke(n),c={};r&&(c[Ue.FLOW]=r),o&&(c[Ue.INFO]=`${o}(${s[0]})`);const l=new Promise(((n,r)=>{vo((0,u.d9)(e)).then((()=>{i&&a.send(c),t(s).then((e=>{i||a.send(c),n(e)})).catch((({errorCategory:e,errorCodes:t})=>{i||a.send({[Ue.ERROR_CATEGORY]:e||tn,[Ue.ERROR_CODES]:t,...c}),Xe(Tn,t),r(t)}))})).catch((({errorCategory:e,errorCodes:t})=>{a.send({[Ue.ERROR_CATEGORY]:e,[Ue.ERROR_CODES]:t,...c}),Xe(Tn,t),r(t)}))}));if(window.ONEID_WEB_SDK_MIGRATION){const e=$r().defer();return l.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return l}}function ko(){return ln(Te)}function Co(e,t,n){let r;const o=new Promise(((o,i)=>{r=setTimeout((()=>{const r={[Ue.ERROR_CATEGORY]:tn,[Ue.ERROR_CODES]:$t};t&&(r[Ue.INFO]=t),e.send(r),i(n)}),Te)}));return o.cancel=()=>(clearTimeout(r),this),o}function bo(){Nt("loggedIn",!0),br()}function So({key:e,value:t,expires:n,secure:r=!1}){m(e,t,_.getCookieDomain(),"/",n,r)}window.ONEID_WEB_SDK_VERSION="4.1.28",window.ONEID_WEB_SDK_MIGRATION=!1,s(e[g(h)]||e.INFO),i.debug("MOUI (outer) initializing..."),pe.then((e=>{e.addHandler("ui.hideLightbox",an.hideLightbox),e.addHandler("ui.showLightbox",an.showLightbox),e.addHandler("init.setInitialized",Kr),e.addHandler("get.unid",(()=>window.unid&&window.unid.getData?window.unid.getData():{})),e.addHandler("get.cookie",g),e.addHandler("set.cookie",So),e.addHandler("newRelic.send",(e=>{Ye({...e,...xe})})),e.addHandler("api.callback",(e=>{const{name:t,...n}=e;O(t,n)})),e.addHandler("api.emitEvent",(({eventName:e,eventPayload:t})=>Xe(e,t))),e.addHandler("guest.write",(e=>In(e,!0))),e.addHandler("guest.read",_n),e.addHandler("session.loggedIn",bo),e.addHandler("set.s2cookie",St)})),window.OneID||(window.OneID=fo),window.DisneyID||(window.DisneyID=po),function(e="outer"){const t="outer"===e?(document.querySelector('script[src*="/OneID.js"]')||document.querySelector('script[src*="/OneIDMigrate.js"]')||document.querySelector('script[src*="/DisneyID.js"]')||{}).src:window.location.href,n=!!document.querySelector('script[src*="/DisneyID.js"]'),{href:r,host:o}=new URL(t);Ie=n?"outer"===e?r.replace(/^(.*)\/v2\/outer\/DisneyID\.js(?:.+)?/,"$1/v4"):r.split("/bundle")[0]:"outer"===e?r.replace(/^(.*)\/OneID(?:Migrate)?\.js/,"$1"):r.split("/bundle")[0],ge.test(o.toLowerCase())?ye=_e:Ee.test(o.toLowerCase())&&(ye=me)}()})()})();